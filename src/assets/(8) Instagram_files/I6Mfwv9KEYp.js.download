;/*FB_PKG_DELIM*/

__d("CPXComposerConstants",[],(function(t,n,r,o,a,i){"use strict";var e=120,l=68,s=90,u=160,c=10,d=4;i.THUMBNAIL_WIDTH=e,i.THUMBNAIL_HEIGHT=l,i.REEL_THUMBNAIL_WIDTH=s,i.REEL_THUMBNAIL_HEIGHT=u,i.NUM_OF_THUMBNAILS=c,i.MAX_NUM_THUMBNAILS=d}),66);
__d("CanvasToBlobImpl",["BlobFactory"],(function(t,n,r,o,a,i){function e(e,t){for(var r=atob(e.substr(e.indexOf(",")+1)),o=new Uint8Array(r.length),a=0;a<r.length;a++)o[a]=r.charCodeAt(a);return n("BlobFactory").getBlob([o],{type:t})}a.exports={getBlob:e}}),null);
__d("VideoThumbnail_UNTYPED",[],(function(t,n,r,o,a,i){var e=(function(){"use strict";function e(e){this.$1=e}var t=e.prototype;return t.getURL=function(){return this.$1},e})();a.exports=e}),null);
__d("dataURLToBlob",["BlobFactory","CanvasToBlobImpl","CanvasToBlobResource","Promise","WebWorker"],(function(t,n,r,o,a,i,l){var e,s=t.URL||t.webkitURL||{};function u(t,a){return!s.createObjectURL||!r("BlobFactory").isSupported?(e||(e=n("Promise"))).reject("Browser doesn't support this feature"):r("WebWorker").isSupported()?new(e||(e=n("Promise")))(function(e,n){var o=new(r("WebWorker"))(r("CanvasToBlobResource")).setMessageHandler(function(t){e(t),o.terminate()}).setErrorHandler(function(e){n(e.message),o.terminate()}).execute().postMessage({dataURL:t,fileType:a})}):(e||(e=n("Promise"))).resolve(o("CanvasToBlobImpl").getBlob(t,a))}l.default=u}),98);
__d("canvasToBlob",["Promise","dataURLToBlob","promiseDone"],(function(t,n,r,o,a,i,l){var e;function s(t,o,a){return new(e||(e=n("Promise")))(function(e,n){if("toBlob"in t)t.toBlob(e,o,a);else{var i=t.toDataURL(o,a);r("promiseDone")(r("dataURLToBlob")(i,o).then(function(t){e(t)},n))}})}l.default=s}),98);
__d("CanvasVideoThumbnail",["EventListener","Promise","VideoThumbnail_UNTYPED","canvasToBlob","promiseDone"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function o(e,n,r,o,a,i,l){var s;return o===void 0&&(o=null),a===void 0&&(a=null),i===void 0&&(i=0),l===void 0&&(l=0),s=t.call(this,null)||this,s.$CanvasVideoThumbnail$p_1=e,s.$CanvasVideoThumbnail$p_2=n,s.$CanvasVideoThumbnail$p_3=r,s.$CanvasVideoThumbnail$p_4=o,s.$CanvasVideoThumbnail$p_5=a,s.$CanvasVideoThumbnail$p_6=i,s.$CanvasVideoThumbnail$p_7=l,s.$CanvasVideoThumbnail$p_8=s.$CanvasVideoThumbnail$p_1.toDataURL("image/jpeg"),s}babelHelpers.inheritsLoose(o,t);var a=o.prototype;return a.getCanvas=function(){return this.$CanvasVideoThumbnail$p_1},a.getTime=function(){return this.$CanvasVideoThumbnail$p_3?this.$CanvasVideoThumbnail$p_3:0},a.getURL=function(){return this.$CanvasVideoThumbnail$p_8||(this.$CanvasVideoThumbnail$p_8=this.$CanvasVideoThumbnail$p_1.toDataURL("image/jpeg")),this.$CanvasVideoThumbnail$p_8},a.getData=function(){var t=this,o=document.createElement("canvas"),a=o.getContext("2d"),i=this.$CanvasVideoThumbnail$p_2;return new(e||(e=n("Promise")))(function(e,n){var l=r("EventListener").listen(i,"seeked",function(){l.remove(),t.$CanvasVideoThumbnail$p_9(o,a),r("promiseDone")(r("canvasToBlob")(o,"image/jpeg").then(e,n))});i.currentTime=t.$CanvasVideoThumbnail$p_3})},a.getDataWithText=function(o,a,i,l,s,u,c,d){var t=this,m=document.createElement("canvas"),p=m.getContext("2d"),_=this.$CanvasVideoThumbnail$p_2;return new(e||(e=n("Promise")))(function(e,n){var f=r("EventListener").listen(_,"seeked",function(){f.remove(),p.fillStyle=c,p.textAlign=d,t.$CanvasVideoThumbnail$p_9(m,p),p=r("VideoThumbnail_UNTYPED").addTextToCanvasContext(p,o,a,i,l,s,u,c,d),r("promiseDone")(r("canvasToBlob")(m,"image/jpeg").then(e,n))});_.currentTime=t.$CanvasVideoThumbnail$p_3})},a.$CanvasVideoThumbnail$p_9=function(t,n){var e=this.$CanvasVideoThumbnail$p_2;this.$CanvasVideoThumbnail$p_4||this.$CanvasVideoThumbnail$p_5?(t.width=this.$CanvasVideoThumbnail$p_4?this.$CanvasVideoThumbnail$p_4:e.videoWidth,t.height=this.$CanvasVideoThumbnail$p_5?this.$CanvasVideoThumbnail$p_5:e.videoHeight,this.$CanvasVideoThumbnail$p_10(t,n)):(t.width=e.videoWidth,t.height=e.videoHeight,n.drawImage(e,0,0,t.width,t.height))},a.$CanvasVideoThumbnail$p_10=function(t,n){var e=this.$CanvasVideoThumbnail$p_2,r=this.$CanvasVideoThumbnail$p_6,o=this.$CanvasVideoThumbnail$p_7,a=this.$CanvasVideoThumbnail$p_4?this.$CanvasVideoThumbnail$p_4:t.width,i=this.$CanvasVideoThumbnail$p_5?this.$CanvasVideoThumbnail$p_5:t.height;n.drawImage(e,r,o,a,i,0,0,t.width,t.height)},o})(r("VideoThumbnail_UNTYPED"));l.default=s}),98);
__d("HTMLMediaElementReadyStates",[],(function(t,n,r,o,a,i){var e={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},l=e;i.default=l}),66);
__d("useIGDBroadcastChannelImpressionLoggerWithCheck",["MWCMThreadTypes.react","promiseDone","react","react-compiler-runtime","useIGDBroadcastChannelLogger","useSinglePartialViewImpression"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useCallback;function u(e,t,n){var a=o("react-compiler-runtime").c(6),i=r("useIGDBroadcastChannelLogger")(e),l;a[0]!==i||a[1]!==n||a[2]!==t?(l=function(){t!=null&&o("MWCMThreadTypes.react").isIGBroadcastChannelThread(t)&&r("promiseDone")(i(n))},a[0]=i,a[1]=n,a[2]=t,a[3]=l):l=a[3];var s=l,u;return a[4]!==s?(u={onImpressionStart:s},a[4]=s,a[5]=u):u=a[5],r("useSinglePartialViewImpression")(u)}l.default=u}),98);
__d("useIGDTriggerEditAction.react",["MAWEditMessageContext.react","MWPReplyContext.react","MessengerWebUXLogger","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useCallback,c=s.useContext;function d(e,t,n){var a=o("react-compiler-runtime").c(10),i=r("MessengerWebUXLogger").useInteractionLogger(),l=c(o("MAWEditMessageContext.react").Context),s=l.setEditMessageData,u=c(o("MWPReplyContext.react").MWPReplyContext),d=u.clearReply,m=u.reply,p;return a[0]!==d||a[1]!==i||a[2]!==e.messageId||a[3]!==e.threadKey||a[4]!==e.timestampMs||a[5]!==n||a[6]!==m||a[7]!==s||a[8]!==t?(p=function(){m!=null&&d(e.threadKey,!0),s({messageId:e.messageId,threadKey:e.threadKey,threadType:t,timestampMs:e.timestampMs}),i==null||i({eventName:"edit_message_tap"}),n==null||n()},a[0]=d,a[1]=i,a[2]=e.messageId,a[3]=e.threadKey,a[4]=e.timestampMs,a[5]=n,a[6]=m,a[7]=s,a[8]=t,a[9]=p):p=a[9],p}l.default=d}),98);
__d("useMWIsContactRestricted",["LSContactBitOffset"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e!=null&&o("LSContactBitOffset").has(66,e);return t}l.default=e}),98);
__d("useMWPCanUserEditMessage",["I64","LSAuthorityLevel","LSContactBitOffset","LSContactTypeExact","LSHotEmojiSize","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MAWThreadCutover","MWMessageDeliveryStatus","MWPActor.react","ReQL","ReQLSuspense","URLMatcher","getIsMessageTimeBelowEditThreshold","gkx","isDeliveryStatusErrorState","isMWBumpMessage","isStringNullOrEmpty","mwCMIsAnyCMThread","mwCMIsCMSubthread","useMWGetOtherUserContact","useMWIsContactRestricted","useReStore","useServerTime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=5;function d(t,n,a){var l,d,p,_,f=o("MWPActor.react").useActor(),g=(u||(u=r("useReStore")))(),h=o("ReQLSuspense").useFirst(function(){return o("ReQL").fromTableAscending(g.tables.attachments).getKeyRange(t.threadKey,t.messageId)},[g,t.messageId,t.threadKey],i.id+":68"),y=r("useMWGetOtherUserContact")(t.threadKey,n.threadType,["contactTypeExact"].concat(o("LSContactBitOffset").contactCapabilityFields)),C=y!=null&&(e||(e=o("I64"))).equal(y.contactTypeExact,(s||(s=o("LSIntEnum"))).ofNumber(r("LSContactTypeExact").MESSENGER_KID)),b=r("useMWIsContactRestricted")(y),v=o("MAWThreadCutover").useIsCutoverOpenThread(a),S=r("useServerTime")();if(r("isDeliveryStatusErrorState")(o("MWMessageDeliveryStatus").getFromSendStatus(t.sendStatusV2))||n==null)return!1;var R=(e||(e=o("I64"))).to_int32((l=t.editCount)!=null?l:(e||(e=o("I64"))).zero)<c,L=o("getIsMessageTimeBelowEditThreshold").getIsMessageTimeBelowEditThreshold(e.of_float(S.getTime()),t.timestampMs),E=e.equal(t.senderId,f),k=(d=t.isForwarded)!=null?d:!1,I=t.text!=null&&t.text!=="",T=t.text!=null&&r("URLMatcher").match(t.text)!=null,D=e.equal((p=t.hotEmojiSize)!=null?p:(e||(e=o("I64"))).zero,(s||(s=o("LSIntEnum"))).ofNumber(r("LSHotEmojiSize").NONE)),x=((_=h==null?void 0:h.hasXma)!=null?_:!1)||!r("isStringNullOrEmpty")(t.mentionIds),$=t.isUnsent===!1&&(e||(e=o("I64"))).equal(t.authorityLevel,(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE)),P=r("isMWBumpMessage")(t.replyType);return R&&L&&E&&I&&!T&&D&&!k&&!v&&!x&&$&&!b&&!P&&!C&&m(n)}function m(e){var t=e.threadType;return o("LSMessagingThreadTypeUtil").isWorkThread(e.threadSubtype)?!1:o("LSMessagingThreadTypeUtil").isArmadilloSecure(t)||o("LSMessagingThreadTypeUtil").isJoinedDiscoverablePublicBroadcastChannel(t)?!0:r("mwCMIsAnyCMThread")(t)||r("mwCMIsCMSubthread")(t)?o("LSThreadBitOffset").has(194,e)&&r("gkx")("7675"):!!o("LSMessagingThreadTypeUtil").isOpenFnFThread(e)}l.default=d}),98);
__d("useIGDEditMessageMenuItem.react",["fbt","I64","IGDMessageContextMenuItem.react","IGDSEditPanoOutline24Icon.react","MWPActor.react","react","react-compiler-runtime","useIGDTriggerEditAction.react","useMWPCanUserEditMessage"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react"));function d(e,t,n){var a=o("react-compiler-runtime").c(4),i=o("MWPActor.react").useActor(),l=e.senderId,d=(u||(u=o("I64"))).equal(l,i),m=r("useIGDTriggerEditAction.react")(e,n.threadType,t),p=r("useMWPCanUserEditMessage")(e,n);if(!d||!p)return null;var _;a[0]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Editar"),a[0]=_):_=a[0];var f=_,g;a[1]===Symbol.for("react.memo_cache_sentinel")?(g=c.jsx(r("IGDSEditPanoOutline24Icon.react"),{alt:f,size:18}),a[1]=g):g=a[1];var h;return a[2]!==m?(h=c.jsx(r("IGDMessageContextMenuItem.react"),{icon:g,label:f,onClick:function(){m()},testid:void 0}),a[2]=m,a[3]=h):h=a[3],h}l.default=d}),226);
__d("useIGDMessageCopyMenuItem.react",["fbt","Clipboard","I64","IGDMessageContextMenuItem.react","IGDSBox.react","IGDSCircleCheckOutlineIcon.react","IGDSCopyPanoOutline24Icon.react","IGDThreadListNewMessageLoggingDataContext","Int64Hooks","LSIntEnum","LSMessageReplySourceTypeV2","MWPActor.react","MessengerWebUXLogger","PolarisUA","promiseDone","react","react-compiler-runtime","requireDeferred","useIGDSToaster","usePolarisShowToast","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d,m=d||(d=o("react")),p=r("requireDeferred")("MWLogMessageAction").__setRef("useIGDMessageCopyMenuItem.react");function _(t,n,a,i){var l=o("react-compiler-runtime").c(27),d=(e||(e=r("useReStore")))(),_=o("MWPActor.react").useActor(),f=r("MessengerWebUXLogger").useInteractionLogger(),g=o("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),h=t.displayedContentTypes,y=t.replySourceTypeV2!=null&&(u||(u=o("LSIntEnum"))).toNumber(t.replySourceTypeV2)===r("LSMessageReplySourceTypeV2").FORWARD,C=(c||(c=o("I64"))).equal(h,(u||(u=o("LSIntEnum"))).ofNumber(1))||(c||(c=o("I64"))).equal(h,(u||(u=o("LSIntEnum"))).ofNumber(1033)),b=!i&&(C||y&&!!t.text),v=r("useIGDSToaster")(),S=r("usePolarisShowToast")(),R;l[0]!==_||l[1]!==d||l[2]!==g||l[3]!==f||l[4]!==t.messageId||l[5]!==t.senderId||l[6]!==t.text||l[7]!==t.threadKey||l[8]!==n||l[9]!==S||l[10]!==v?(R=function(){var e;f==null||f({eventName:"message_copy",extraData:{},flowInstanceId:g}),o("Clipboard").copy((e=t.text)!=null?e:""),n();var a=s._(/*BTDS*/"Copiado"),i=m.jsx(r("IGDSCircleCheckOutlineIcon.react"),{alt:s._(/*BTDS*/"\u00cdcone da marca de sele\u00e7\u00e3o"),color:"web-always-white"});o("PolarisUA").isMobile()?v.add({icon:i,message:a}):S({text:m.jsxs(r("IGDSBox.react"),{alignItems:"center",columnGap:2,direction:"row",children:[i,a]})}),p.onReady(function(e){return r("promiseDone")(e.log(d,t.messageId,t.threadKey,"message_dot_menu","copy",void 0,void 0,void 0,t.senderId,void 0,_))})},l[0]=_,l[1]=d,l[2]=g,l[3]=f,l[4]=t.messageId,l[5]=t.senderId,l[6]=t.text,l[7]=t.threadKey,l[8]=n,l[9]=S,l[10]=v,l[11]=R):R=l[11];var L;l[12]!==_||l[13]!==d||l[14]!==g||l[15]!==f||l[16]!==t.messageId||l[17]!==t.senderId||l[18]!==t.text||l[19]!==t.threadKey||l[20]!==n||l[21]!==a?(L=[_,d,g,f,t.messageId,t.senderId,t.text,t.threadKey,n,a],l[12]=_,l[13]=d,l[14]=g,l[15]=f,l[16]=t.messageId,l[17]=t.senderId,l[18]=t.text,l[19]=t.threadKey,l[20]=n,l[21]=a,l[22]=L):L=l[22];var E=o("Int64Hooks").useCallbackInt64(R,L);if(!b)return null;var k;l[23]===Symbol.for("react.memo_cache_sentinel")?(k=s._(/*BTDS*/"Copiar"),l[23]=k):k=l[23];var I=k,T;l[24]===Symbol.for("react.memo_cache_sentinel")?(T=m.jsx(r("IGDSCopyPanoOutline24Icon.react"),{alt:I,size:18}),l[24]=T):T=l[24];var D;return l[25]!==E?(D=m.jsx(r("IGDMessageContextMenuItem.react"),{icon:T,label:I,onClick:E}),l[25]=E,l[26]=D):D=l[26],D}l.default=_}),226);
__d("MAWDocumentPreProcess",["WABlobToArrayBuffer","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WATagsLogger").TAGS(["MAWDocumentPreProcess"]);async function c(t){return u.DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["start document preprocess"]))),Promise.resolve({file:t,filename:t.name,plaintext:await o("WABlobToArrayBuffer").blobToArrayBuffer(t),type:"document"})}function d(e){u.DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["start optimistic document preprocess"])));var n=t.URL.createObjectURL(e);return Promise.resolve({file:e,filename:e.name,type:"document",url:n})}l.documentPreprocess=c,l.optimisticDocumentPreprocess=d}),98);
__d("MAWFetchXMADataUtils",["FBLogger","LSXmaContentType","MAWFetchXMABlob","MAWGetImageSpec","MAWParseXMAFBConfig","WAArmadilloXMA.pb","sendToSentQPLLogger"],(function(t,n,r,o,a,i,l){"use strict";var e={failed_to_fetch_blob_for_xma_share:"Failed to fetch blob xma data for MAWShareAttachent",failed_to_fetch_json_for_xma_share:"Failed execute MAWShareAttachment_LinkPreviewQuery for MAWShareAttachent",failed_to_parse_json_for_xma_share:"Failed to fetch blob xma data for MAWShareAttachent"};function s(e){var t=Object.entries(r("LSXmaContentType")).find(function(t){var n=t[0],r=t[1];return e===r&&n in o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE}),n;if(t!=null&&t[0]in o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE){var a=t[0];n=o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE[a]}else n=void 0;if(n!==void 0)return o("MAWParseXMAFBConfig").isFBSupportedTargetType({fbTargetType:n,silentExposure:!0})?n:(r("FBLogger")("messenger_web_sharing").mustfix("Unsupported XMA Target Type in sending path: "+n),o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE)}async function u(e,t){var n=e.favicon_blob,r=e.header_image_blob,a=e.overlayIconGlyph,i=e.preview_blob,l=i==null?void 0:new File([i],"preview",{type:i.type}),s=n==null?void 0:new File([n],"favicon",{type:n.type}),u=r==null?void 0:new File([r],"header",{type:r.type});o("sendToSentQPLLogger").markSendToSentPoint(t,"preview_favicon_spec_start");var c=a===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE?Promise.resolve({height:2,width:2}):l!=null?o("MAWGetImageSpec").getImageSpec_DEPRECATED(l):Promise.resolve(),d=s!=null?o("MAWGetImageSpec").getImageSpec_DEPRECATED(s):Promise.resolve(),m=u!=null?o("MAWGetImageSpec").getImageSpec_DEPRECATED(u):Promise.resolve(),p=await Promise.all([c,d,m]),_=p[0],f=p[1],g=p[2];o("sendToSentQPLLogger").markSendToSentPoint(t,"preview_favicon_spec_ready");var h=l==null||_==null?void 0:{file:l,height:_.height,width:_.width},y=s==null||f==null?void 0:{file:s,height:f.height,width:f.width},C=u==null||g==null?void 0:{file:u,height:g.height,width:g.width};return{faviconFileArgs:y,headerImageFileArgs:C,previewFileArgs:h}}async function c(t,n,a,i,l,s){var u=await Promise.all([[(t==null?void 0:t.startsWith("ls"))===!0?null:t,"favicon"],[n,"image"],[a,"preview"],[i,"header_image"]].map(function(e){return o("MAWFetchXMABlob").fetchBlob({descriptionForLogging:"MAWFetchXMAData_"+e[1],url:e[0],xmaContentType:s}).then(function(e){return e!=null?e:void 0})})).catch(function(t){return l.forEach(function(e){o("sendToSentQPLLogger").markSendToSentFail(e,"failed_to_fetch_blob_for_xma_share")}),r("FBLogger")("messenger_web_sharing").catching(t).mustfix(e.failed_to_fetch_blob_for_xma_share),[void 0,void 0,void 0,void 0]}),c=u[0],d=u[1],m=u[2],p=u[3];return[c,d,m,p]}l.XMA_DATA_ERRORS=e,l.convertXmaContentTypeToMessageType=s,l.makeXMAFileArgs=u,l.getPreviewBlobs=c}),98);
__d("MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9840669832713841"}),null);
__d("MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql",["MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"url"}],t=[{alias:null,args:[{fields:[{kind:"Variable",name:"url",variableName:"url"}],kind:"ObjectValue",name:"params"}],concreteType:"XFBXMAPreviewData",kind:"LinkedField",name:"xma_preview_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_receiver_fetch_supported",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_public",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"post_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"default_cta_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"header_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subtitle_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"xma_content_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"favicon_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"header_image_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"preview_url",storageKey:null},{alias:null,args:null,concreteType:"XFBXMAPreviewDataCtaDataConnection",kind:"LinkedField",name:"cta_data",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBXMACtaData",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cta_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cta_action_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cta_native_url",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",selections:t},params:{id:n("MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation"),metadata:{},name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("MAWUnshimUrl",["CometLinkShimUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e!=null){var t=o("CometLinkShimUtils").getLinkShimInfo(e,void 0,void 0,void 0,void 0,void 0,!0);return t.shimmed?t.unshimmedHref:e}}l.unshimUrl=e}),98);
__d("MAWFetchXMAData",["fbt","CometRelay","ConstUriUtils","FBLogger","LSXmaContentType","MAWFetchXMADataUtils","MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql","MAWUnshimUrl","MSGDataclassTypes.flow","WAArmadilloXMA.pb","getJSEnumSafe","isFacebookURI","isStringNullOrEmpty","sendToSentQPLLogger"],(function(t,n,r,o,a,i,l,s){"use strict";var e;function u(e,t){var n;return t.forEach(function(e){o("sendToSentQPLLogger").addSendToSentAnnotations(e,{string:{xma_data_result:"private"}})}),{defaultCTA:{actionUrl:o("MAWUnshimUrl").unshimUrl(e),buttonType:(n=o("WAArmadilloXMA.pb")).EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:o("MAWUnshimUrl").unshimUrl(e),title:s._(/*BTDS*/"_j[\"Post privado\",\"599d20d959e0009397c73fb9edb426dd\",1]").toString()},linkType:"internal",overlayIconGlyph:n.EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE,preview_blob:void 0,title_text:s._(/*BTDS*/"Facebook").toString(),transportLayerForLogging:"sender_copy",xma_message_type:n.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE,xmaTargetTypeForLogging:n.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE}}function c(t,r){return o("CometRelay").fetchQuery(t,e!==void 0?e:e=n("MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql"),{url:r}).toPromise()}async function d(e,t,n){var a,i,l,s,d,m,p=await c(e,t).catch(function(e){n.forEach(function(t){o("sendToSentQPLLogger").markSendToSentFail(t,"failed_to_fetch_json_for_xma_share",e)}),r("FBLogger")("messenger_web_sharing").catching(e).mustfix(o("MAWFetchXMADataUtils").XMA_DATA_ERRORS.failed_to_fetch_json_for_xma_share)});n.forEach(function(e){o("sendToSentQPLLogger").markSendToSentPoint(e,"fetch_json_for_xma_share_end")});var _=p==null?void 0:p.xma_preview_data;if(_==null)return n.forEach(function(e){o("sendToSentQPLLogger").addSendToSentAnnotations(e,{string:{xma_data_result:"empty"}})}),u(t,n);if(_.is_public!==!0)return u(t,n);n.forEach(function(e){o("sendToSentQPLLogger").addSendToSentAnnotations(e,{string:{xma_data_result:"public"}})});var f={defaultCTA:{actionUrl:o("MAWUnshimUrl").unshimUrl(t),buttonType:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:o("MAWUnshimUrl").unshimUrl(t),title:(a=_.default_cta_title)!=null?a:void 0},linkType:"internal",title_text:(i=(l=_.title_text)!=null?l:_.header_title)!=null?i:void 0},g=r("getJSEnumSafe")(r("LSXmaContentType"),_.xma_content_type),h=o("MAWFetchXMADataUtils").convertXmaContentTypeToMessageType(g),y=_.post_id,C=_.is_receiver_fetch_supported===!0;if(C&&y!=null){var b={__typename:"XMSGMsgrXmaContentRefDataclass",action_type:o("MSGDataclassTypes.flow").XmsgMsgrXmaActionType.Share,content_type:o("MSGDataclassTypes.flow").XmsgMsgrReceiverFetchContentType.Statusupdate,fetch_params:{__typename:"XMSGMsgrReceiverFetchXmaStatusUpdateFetchParams",post_id:y},xma_content_type:r("getJSEnumSafe")(r("LSXmaContentType"),_.xma_content_type),xma_layout_type:o("MSGDataclassTypes.flow").XmsgMsgrReceiverFetchXmaLayoutType.Single};return babelHelpers.extends({},f,{contentRef:JSON.stringify(b),transportLayerForLogging:"receiver_fetch",xma_message_type:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH,xmaTargetTypeForLogging:h})}var v=await o("MAWFetchXMADataUtils").getPreviewBlobs(_.favicon_url,null,_.preview_url,_.header_image_url,n,g),S=v[0],R=v[1],L=v[2],E=v[3];return babelHelpers.extends({},f,{ctas:(s=_.cta_data)==null||(s=s.nodes)==null?void 0:s.map(function(e){var t,n=o("MAWUnshimUrl").unshimUrl(r("isStringNullOrEmpty")(e.cta_action_url)?void 0:e.cta_action_url),a=o("MAWUnshimUrl").unshimUrl(r("isStringNullOrEmpty")(e.cta_native_url)?void 0:e.cta_native_url);return{actionUrl:n,buttonType:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,ctaType:"xma_web_url",nativeUrl:a,title:(t=e.cta_title)!=null?t:void 0}}),favicon_blob:S!=null?S:void 0,header_image_blob:E!=null?E:void 0,header_title:r("isStringNullOrEmpty")(_.title_text)?void 0:(d=_.header_title)!=null?d:void 0,preview_blob:L!=null?L:void 0,subtitle_text:(m=_.subtitle_text)!=null?m:void 0,transportLayerForLogging:"sender_copy",xma_message_type:h,xmaTargetTypeForLogging:h})}function m(e,t,n){var a,i=o("ConstUriUtils").getUri(t),l=i==null||(a=i.setSubDomain("www"))==null?void 0:a.toString();if(l==null)return Promise.resolve({linkType:"unknown",transportLayerForLogging:"sender_copy",xmaTargetTypeForLogging:null});var s=o("MAWUnshimUrl").unshimUrl(t);if(s!=null){var u=o("ConstUriUtils").getUri(s);if(u!=null&&!r("isFacebookURI")(u))return Promise.resolve({linkType:"external",transportLayerForLogging:"sender_copy",xma_message_type:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE,xmaTargetTypeForLogging:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE})}return n.forEach(function(e){o("sendToSentQPLLogger").markSendToSentPoint(e,"fetch_json_for_xma_share_start")}),d(e,l,n)}l.fetchXMAData=m}),226);
__d("MAWThreadMappingUtils",["FBLogger","LSMessagingThreadTypeUtil","MAWJids","MAWMiActOnActThreadReadyInstrumentation","ReQL","ReQLSubscribe","err","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e=3e4;async function s(e,t){var n=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.threads).getKeyRange(t));return n==null?(r("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used."),null):o("LSMessagingThreadTypeUtil").isGroup(n.threadType)}function u(e,t){return Promise.all([s(e,t),o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.mi_act_mapping_table).getKeyRange(t))]).then(function(e){var t=e[0],n=e[1];return n==null||t==null?(r("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used."),null):o("MAWJids").convertIntJidToChatJid(n.jid,t)})}function c(e,t){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.mi_act_mapping_table).getKeyRange(t)).then(function(e){return e==null?(r("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used."),null):e.jid})}async function d(t,n,a){var i,l=null,c=(i=o("MAWMiActOnActThreadReadyInstrumentation")).getOnActThreadReadyInstanceKey(a);i.startQPL(c,a,n,"getChatJidOnceInThreadMappingTable"),i.addPointQPL(c,"get_existing_int_jid_from_mapping_table_start");var d=await u(t.tables,n);if(i.addPointQPL(c,"get_existing_int_jid_from_mapping_table_end"),d!=null)return o("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(c),Promise.resolve(d);var m=await s(t.tables,n);if(m==null)throw o("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(c,"thread_not_ready_to_be_used"),r("FBLogger")("messenger_web").mustfixThrow("Thread is not ready to be used.");return o("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(c,"subscribe_to_mapping_table_start"),new Promise(function(a,i){var s=o("ReQL").fromTableDescending(t.tables.mi_act_mapping_table).getKeyRange(n),u=o("ReQLSubscribe").subscribeToFirst(s,function(e){e!=null&&(l!=null&&window.clearTimeout(l),u(),o("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(c,"subscribe_to_mapping_table_end"),o("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(c),a(o("MAWJids").convertIntJidToChatJid(e.jid,m)))});l=r("setTimeout")(function(){u(),o("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(c,"subscribe_to_mapping_table_timeout"),i(r("err")("Timeout waiting for int jid to be populated in mapping table."))},e)})}async function m(t,n,a){var i,l=null,s=(i=o("MAWMiActOnActThreadReadyInstrumentation")).getOnActThreadReadyInstanceKey(a);i.startQPL(s,a,n,"getIntJidOnceInThreadMappingTable"),i.addPointQPL(s,"get_existing_int_jid_from_mapping_table_start");var u=await c(t.tables,n);return i.addPointQPL(s,"get_existing_int_jid_from_mapping_table_end"),u!=null?(o("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(s),Promise.resolve(u)):(o("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(s,"subscribe_to_mapping_table_start"),new Promise(function(a,i){var u=o("ReQL").fromTableDescending(t.tables.mi_act_mapping_table).getKeyRange(n),c=o("ReQLSubscribe").subscribeToFirst(u,function(e){e!=null&&(l!=null&&window.clearTimeout(l),c(),o("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(s,"subscribe_to_mapping_table_end"),o("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(s),a(e.jid))});l=r("setTimeout")(function(){c(),o("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(s,"subscribe_to_mapping_table_timeout"),i(r("err")("Timeout waiting for int jid to be populated in mapping table."))},e)}))}l.isThreadGroup=s,l.getChatJidFromMappingTable=u,l.getIntJidFromMappingTable=c,l.getChatJidOnceInThreadMappingTable=d,l.getIntJidOnceInThreadMappingTable=m}),98);
__d("MAWGetProtocolMsgIdByMsgIdInUI",["I64","LSDatabaseSingleton","MAWMpsGating","MAWThreadMappingUtils","MAWUserJidWrapper","WAJids","WAStanzaUtils"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WAJids").createJidUtils({platform:"msgr"});async function c(t){var n=await(e||(e=o("LSDatabaseSingleton"))).getLSDatabaseSingletonPromiseOrValue();return n.runInTransaction(async function(e){var n=await e.messages.index("messageId").get(t);if(n==null)return null;var r=await o("MAWThreadMappingUtils").getChatJidFromMappingTable(e,n.threadKey);if(r!=null)return{author:u.toUserJid((s||(s=o("I64"))).to_float(n.senderId).toString()),chat:r,externalId:o("WAStanzaUtils").toStanzaId(n.offlineThreadingId)}},"readonly",void 0,void 0,i.id+":32")}var d=async function(t){if(o("MAWMpsGating").isFullMpsEnabled())return c(t);var e=await c(t);return e!=null&&o("MAWUserJidWrapper").getMyUserJid()===e.author?{author:"@me",chat:e.chat,externalId:e.externalId}:e};l.getProtocolMsgIdByMsgIdUI=d}),98);
__d("MAWSendFileMsgTypes",["WAStanzaUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e}function s(e){return o("WAStanzaUtils").toStanzaId(e)}l.toOfflineAttachmentIDFromStanzaId=e,l.toOfflineAttachmentIDFromString=s}),98);
__d("MAWSecureAttachmentGroupingUtils",["I64","LSIntEnum","MAWSendFileMsgTypes","MessagingAttachmentType","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var n=t.reduce(function(t,n){return(e||(e=o("I64"))).equal(n.attachmentType,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))?t.mediaStagingsImage.push(n):t.mediaStagingsOther.push(n),t},{mediaStagingsImage:[],mediaStagingsOther:[]}),a=n.mediaStagingsImage,i=n.mediaStagingsOther;return[].concat(a,i)}function c(t){var n=new Map,a=t.filter(function(t){return(e||(e=o("I64"))).equal(t.attachmentType,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))}),i=a.length;if(i>1){var l=r("uuidv4")();a.forEach(function(e,t){n.set(o("MAWSendFileMsgTypes").toOfflineAttachmentIDFromString(e.offlineAttachmentId),{groupId:l,groupIndex:t,groupSize:i})})}return n}function d(e){var t=new Map,n=e.length;if(n>1){var o=r("uuidv4")();e.forEach(function(e,r){t.set(e,{groupId:o,groupIndex:r,groupSize:n})})}return t}l.orderMediaStagingsForGrouping=u,l.generateMediaGroupMetadataForMediaStagings=c,l.generateMediaGroupMetadataForMessageIds=d}),98);
__d("MAWForwardMessage",["MAWBridgeSendAndReceive","MAWCreateOneToOneThread","MAWExternalId","MAWGetEphemeralSettings","MAWGetProtocolMsgIdByMsgIdInUI","MAWMessageSendReporter","MAWMiActOnActThreadReady","MAWSecureAttachmentGroupingUtils","MAWThreadId","WAResultOrError","qpl"],(function(t,n,r,o,a,i,l){"use strict";async function e(e,t,n,r){var a=await o("MAWThreadId").isSecureThreadKey(e.tables,t);if(!a){var i=await o("MAWCreateOneToOneThread").call(e,t,void 0,"MAWForwardMessage",r),l=i.jid;return n(l,!0)}var s=await o("MAWMiActOnActThreadReady").waitForACTThreadReady(e.tables,t,"MAWForwardMessage"),u=s.chatJid;return n(u,!1)}function s(e,t,n,r,o,a){return c(e,t,n,r,o,void 0,a)}async function u(e,t,n,r,a){var i=o("MAWSecureAttachmentGroupingUtils").generateMediaGroupMetadataForMessageIds(n);await Promise.allSettled([n.map(function(n){return c(e,t,n,r,a,i.get(n))})])}function c(t,n,a,i,l,s,u){var c=o("MAWExternalId").generateExternalId();return e(t,n,function(e,d){return o("MAWGetProtocolMsgIdByMsgIdInUI").getProtocolMsgIdByMsgIdUI(a).then(function(a){return a!=null?o("MAWGetEphemeralSettings").getEphemeralSetting(e,n).then(function(n){var m=o("MAWBridgeSendAndReceive").sendAndReceive("backend","forwardMsg",{args:{args:{mediaGroupMetadata:s,source:i},chatJid:e,ephemeralSetting:n!=null?n:void 0,externalId:c,isFirstMsg:d,protocolMsgId:a,textWithSubstitutions:u},qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:l});return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:e,externalId:c},m,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:l},t)}):o("WAResultOrError").makeResult({description:"unexpected null protocolMsgId",messageType:"fixMe"})})},l)}l.maybeCreateNewThreadAndCallback=e,l.forwardMessage=s,l.forwardMessageBatch=u}),98);
__d("VideoFrameBuffer",["HTMLMediaElementReadyStates","getErrorSafe"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e,t,n,r,o,a,i){r===void 0&&(r=null),o===void 0&&(o=null),a===void 0&&(a=null),i===void 0&&(i=null),this.$2=t,this.$1=e,this.$3=n||"contain",this.$6=r,this.$7=o,this.$8=a,this.$9=i}var t=e.prototype;return t.updateFrameBuffer=function(){if(this.$4&&(this.$1.width=this.$4,this.$4=null),this.$5&&(this.$1.height=this.$5,this.$5=null),!(this.$2.readyState<r("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)){var e=this.$1.clientWidth||this.$1.width,t=this.$1.clientHeight||this.$1.height,n=e,o=t,a=this.$2.videoWidth/this.$2.videoHeight,i=n/o;this.$3==="cover"&&(i*=-1,a*=-1),i>a?n=o*a:i<a&&(o=n/a);var l=this.$1.getContext("2d");if(l instanceof window.CanvasRenderingContext2D)try{if(this.$6||this.$7){var s,u,c,d;l.drawImage(this.$2,(s=this.$8)!=null?s:0,(u=this.$9)!=null?u:0,(c=this.$6)!=null?c:e,(d=this.$7)!=null?d:t,0,0,e,t)}else l.drawImage(this.$2,(e-n)/2,(t-o)/2,n,o)}catch(e){var m=r("getErrorSafe")(e);if(m.name!=="NS_ERROR_NOT_AVAILABLE")throw m}}},t.getDOMNode=function(){return this.$1},t.updateDimensions=function(t,n){this.$4=t,this.$5=n},e})();l.default=e}),98);
__d("generateVideoThumbnails",["CPXComposerConstants","CanvasVideoThumbnail","HTMLMediaElementReadyStates","Promise","VideoFrameBuffer","cr:909281","gkx"],(function(t,n,r,o,a,i,l){var e,s=.5625,u=60;function c(t,o,a,i,l,s,c,g,h,y){return l===void 0&&(l="contain"),s===void 0&&(s=0),c===void 0&&(c=null),g===void 0&&(g=null),h===void 0&&(h=null),y===void 0&&(y=null),new(e||(e=n("Promise")))(function(e,C){var b=document.createElement("canvas"),v=[],S=0,R=t.duration-s;y!=null&&(R=Math.min(R,y));var L=r("gkx")("3728");L&&(R=Math.min(R,u));var E=R/i,k=null,I=null,T,D=g!=null?g:d(c,o),x=h!=null?h:m(c,a),$=p(c,o),P=_(c,a);b.width=D!=null?D:o,b.height=x!=null?x:a;var N=new(r("VideoFrameBuffer"))(b,t,l,D,x,$,P);N.updateFrameBuffer();var M=function(){N.updateFrameBuffer();var e=new(r("CanvasVideoThumbnail"))(b,t,s+(S-1)*E,D,x,$,P);v.push(e),(!k||e.getURL().length>k.getURL().length)&&(k=e,I=f(c,t)),A()},w=function(){if(t.readyState>=r("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)M();else if(n("cr:909281")!==null)var e=n("cr:909281").listen(t,"loadeddata",function(){e.remove(),M()});else t.addEventListener("loadeddata",M,{once:!0})},A=function(){S===0&&(n("cr:909281")!==null?T=n("cr:909281").listen(t,"seeked",w):t.addEventListener("seeked",w)),S<i?(t.currentTime=s+S*E,S++):(n("cr:909281")!==null?T&&T.remove():t.removeEventListener("seeked",w),e({thumbnails:v,selectedThumbnail:k,croppedThumbnailUri:I}))};if(t.videoWidth===0||t.videoHeight===0){C();return}A()})}function d(e,t){if(e&&e.spherical){if(e.stereoMode==="left-right")return t/2;if(e.projectionType==="cubemap")return t/3}return null}function m(e,t){return e&&e.spherical&&(e.stereoMode==="top-bottom"||e.projectionType==="cubemap")?t/2:null}function p(e,t){return e&&e.spherical&&e.projectionType==="cubemap"?t/3:0}function _(e,t){return e&&e.spherical&&e.projectionType==="cubemap"?t/2:0}function f(e,t){var n=t.videoWidth!=null&&t.videoHeight!=null?t.videoWidth/t.videoHeight:s,r=n<1;if(e==null&&!r){var a=document.createElement("canvas"),i=a.getContext("2d"),l=t.videoWidth,u=t.videoHeight;a.width=l,a.height=u,i.drawImage(t,0,0,l,u);var c=document.createElement("canvas"),d,m;n>=1&&n<1.2?(d=l*(o("CPXComposerConstants").REEL_THUMBNAIL_WIDTH/o("CPXComposerConstants").REEL_THUMBNAIL_HEIGHT),m=u):(d=u,m=l),c.width=d,c.height=m;var p=c.getContext("2d");return p.drawImage(a,0,0,l,u,0,0,d,m),c.toDataURL("image/jpeg")}return null}l.default=c}),98);
__d("MAWVideoUtils",["FBLogger","MAWImageUtils","Promise","generateVideoThumbnails"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var a=document.body;if(!a)return new(e||(e=n("Promise")))(function(e,t){return t("Unable to find DOM body, please use this util only in DOM environment.")});var i=document.createElement("video");return new(e||(e=n("Promise")))(function(o,l){i.setAttribute("style","display: none"),i.setAttribute("src",URL.createObjectURL(t)),i.addEventListener("loadedmetadata",function(t){var a=t.currentTarget;if(a instanceof HTMLVideoElement){var s=a.duration,u=a.videoHeight,c=a.videoWidth,d=r("generateVideoThumbnails")(i,c,u,1);o((e||(e=n("Promise"))).all([d,c,u,Math.round(s)]))}else l("EventTarget returned for event should be HTMLVideoElement")}),i.addEventListener("error",function(e){l("Unable to load video")}),a.appendChild(i)}).then(function(e){var t=e[0],n=e[1],r=e[2],l=e[3];return a.removeChild(i),o("MAWImageUtils").canvasToBlob(t.thumbnails[0].getCanvas(),o("MAWImageUtils").TYPE_JPEG,!0).then(function(e){return e.arrayBuffer().then(function(e){return{duration:l,height:r,jpegThumbnail:e,width:n}})})}).catch(function(e){throw a.removeChild(i),r("FBLogger")("messenger_web").mustfixThrow(e)})}function u(t){var o=document.body;if(!o)return new(e||(e=n("Promise")))(function(e,t){return t("Unable to find DOM body, please use this util only in DOM environment.")});var a=document.createElement("video");return new(e||(e=n("Promise")))(function(e,n){a.setAttribute("style","display: none"),a.setAttribute("src",URL.createObjectURL(t)),a.addEventListener("loadedmetadata",function(t){var r=t.currentTarget;if(r instanceof HTMLVideoElement){var o=r.duration,a=r.videoHeight,i=r.videoWidth;e({duration:Math.round(o),height:a,width:i})}else n("EventTarget returned for event should be HTMLVideoElement")}),a.addEventListener("error",function(e){n("Unable to load video")}),o.appendChild(a)}).catch(function(e){throw o.removeChild(a),r("FBLogger")("messenger_web").mustfixThrow(e)})}l.getVideoThumbnailUrlAndSpec=s,l.getVideoThumbnailSpec=u}),98);
__d("MAWFowardMessageFromOpenThread",["FBLogger","I64","LSIntEnum","MAWAudioUtils","MAWBridgeSendAndReceive","MAWDocumentPreProcess","MAWFetchXMABlob","MAWFetchXMAData","MAWFetchXMADataUtils","MAWForwardMessage","MAWGetEphemeralSettings","MAWGetImageSpec","MAWImagePreProcess","MAWMessageSendReporter","MAWUnshimUrl","MAWVault","MAWVideoUtils","MessagingAttachmentType","ReQL","WAArmadilloXMA.pb","WABlobToArrayBuffer","gkx","qpl","sendToSentQPLLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u="369239263222822",c="369239343222814",d="369239383222810";function m(e){return e===u||e===c||e===d}function p(e,t){return Promise.all([o("MAWGetImageSpec").getImageSpec_DEPRECATED(e),Promise.resolve(e),t.arrayBuffer(),o("MAWGetImageSpec").getImageSpec_DEPRECATED(t)]).then(async function(e){var t=e[0],n=e[1],r=e[2],a=e[3];return{file:n,imageSpec:t,plaintext:await o("WABlobToArrayBuffer").blobToArrayBuffer(n),thumbnailUrlAndSpec:{duration:void 0,height:a.height,jpegThumbnail:r,width:a.width},type:"image"}})}function _(e){return o("MAWVideoUtils").getVideoThumbnailUrlAndSpec(e).then(async function(t){return{file:e,plaintext:await o("WABlobToArrayBuffer").blobToArrayBuffer(e),thumbnailUrlAndSpec:t,type:"video"}})}async function f(e,t){var n=await o("MAWFetchXMABlob").fetchBlob({descriptionForLogging:"MAWFowardMessageFromOpenThread",url:e}),r=n==null?void 0:new File([n],t,{type:n.type}),a=r!=null?await o("MAWGetImageSpec").getImageSpec_DEPRECATED(r):null;return r!=null&&a!=null?{file:r,height:a.height,width:a.width}:void 0}async function g(e,t,n){var r,a,i=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(n.tables.attachment_ctas).getKeyRange(e));return i==null||t==null&&i.actionUrl==null?null:{actionUrl:(r=i==null?void 0:i.actionUrl)!=null?r:void 0,buttonType:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(a=i==null?void 0:i.actionUrl)!=null?a:void 0,title:t!=null?t:void 0}}async function h(e,t,n,a){var i=await y(t,n);if((i==null?void 0:i.actionUrl)==null)throw o("sendToSentQPLLogger").markSendToSentFail(a,"null_xma_url"),r("FBLogger")("messenger_web_sharing").mustfixThrow("Cannot forward XMA to secure threads without a defaultCTA and actionUrl");var l=await o("MAWFetchXMAData").fetchXMAData(e,i.actionUrl,[a]);if(l.linkType==="unknown")throw o("sendToSentQPLLogger").markSendToSentFail(a,"unknown_xma_link_type"),r("FBLogger")("messenger_web_sharing").mustfixThrow("Cannot forward XMA to secure threads with an unknown link type");return l.linkType==="external"?b(t,i,n,l):C(l,a)}async function y(e,t){var n=e.actionUrl,r=e.defaultCtaId,a=e.defaultCtaTitle;if(r==null)return null;var i=await g(r,a,t);return i!=null?i:{actionUrl:n!=null?n:void 0,buttonType:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:n!=null?n:void 0,title:a!=null?a:void 0}}async function C(e,t){var n=await o("MAWFetchXMADataUtils").makeXMAFileArgs(e,t),r=e.contentRef,a=e.ctas,i=e.defaultCTA,l=e.overlayIconGlyph,s=e.subtitle_text,u=e.title_text,c=e.xma_message_type,d={contentRef:r,ctas:a,defaultCTA:i,overlayIconGlyph:l,subtitleText:s,titleText:u};return babelHelpers.extends({},n,{xmaArgs:d,xmaMessageType:c!=null?c:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE})}async function b(t,n,r,a){var i=t.attachmentCta1Id,l=t.attachmentCta2Id,s=t.attachmentCta3Id,u=t.cta1Title,c=t.cta2Title,d=t.cta3Title,m=t.faviconUrl,p=t.headerImageUrl,_=t.headerTitle,h=t.maxSubtitleNumOfLines,y=t.maxTitleNumOfLines,C=t.previewUrl,b=t.subtitleText,v=t.titleText,S=await Promise.all([[m,"favicon"],[p,"headerImage"],[C,"preview"]].map(function(e){return f(e[0],e[1])})),R=S[0],L=S[1],E=S[2],k=[];if(i!=null){var I=await g(i,u,r);I!=null&&k.push(I)}if(l!=null){var T=await g(l,c,r);T!=null&&k.push(T)}if(s!=null){var D=await g(s,d,r);D!=null&&k.push(D)}var x={contentRef:a.contentRef,ctas:k.map(function(e){return babelHelpers.extends({},e,{actionUrl:o("MAWUnshimUrl").unshimUrl(e.actionUrl),nativeUrl:o("MAWUnshimUrl").unshimUrl(e.nativeUrl)})}),defaultCTA:babelHelpers.extends({},n,{actionUrl:o("MAWUnshimUrl").unshimUrl(n.actionUrl),nativeUrl:o("MAWUnshimUrl").unshimUrl(n.nativeUrl)}),headerTitle:_,maxSubtitleNumOfLines:(e||(e=o("I64"))).to_int32(h!=null?h:(e||(e=o("I64"))).zero),maxTitleNumOfLines:e.to_int32(y!=null?y:(e||(e=o("I64"))).zero),overlayIconGlyph:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE,subtitleText:b,titleText:v};return{faviconFileArgs:R,headerFileArgs:L,previewFileArgs:E,xmaArgs:x,xmaMessageType:a.xma_message_type}}function v(t){var n=t.attachmentType,a=t.filename,i=t.playableDurationMs,l=t.playableUrl,u=t.playableUrlMimeType,c=t.previewUrl,d=t.previewUrlMimeType;if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))||(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO))||(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE))||(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE))){if(l==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no playableUrl for this attachment");var m=(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE));if(c!=null){var f=m?c+"&":l,g=m?c+"&":c;return Promise.all([window.fetch(f).then(function(e){return e.blob()}),window.fetch(g).then(function(e){return e.blob()})]).then(function(t){var a=t[0],i=t[1],l=new File([a],"mediaForwardedFromOpenThread",{type:m?d:u}),c=new File([i],"previewForwardedFromOpenThread",{type:d});if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE)))return p(l,c);if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO)))return _(l);if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE)))return p(l,c);throw r("FBLogger")("messenger_web_sharing").mustfixThrow("shouldn't have this error in forward message from open thread")})}var h=m?l+"&":l;return window.fetch(h).then(function(e){return e.blob()}).then(function(t){if(m&&u==="video/mp4")throw r("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is only mp4 url for gif");var i=new File([t],a!=null?a:"mediaForwardedFromOpenThread",{type:u});if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE)))return o("MAWImagePreProcess").imagePreprocess(i,!1);if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO)))return _(i);if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE)))return o("MAWDocumentPreProcess").documentPreprocess(i);if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE)))return Promise.all([o("MAWImagePreProcess").getJpegThumbnailInfo(i,400),o("MAWGetImageSpec").getImageSpec_DEPRECATED(i),Promise.resolve(i)]).then(async function(e){var t=e[0],n=e[1],r=e[2];return{file:r,imageSpec:n,plaintext:await o("WABlobToArrayBuffer").blobToArrayBuffer(r),thumbnailUrlAndSpec:t,type:"image"}});throw r("FBLogger")("messenger_web_sharing").mustfixThrow("shouldn't have this error in forward message from open thread")})}if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO))){if(l!=null)return window.fetch(l+"&").then(function(e){return e.blob()}).then(async function(n){var a=new File([n],"mediaForwardedFromOpenThread",{type:u}),l,s=t.waveformData;if(s!=null&&s!==""&&r("gkx")("20216")){var c=s.split(",").map(Number);if(c.every(function(e){return!Number.isNaN(e)})){var d=o("MAWAudioUtils").recomputeWaveform(c);l=new Uint8Array(d).buffer}else r("FBLogger")("messenger_web_sharing").warn("Waveform data is invalid. Forwarding skipped.")}return{durations:(e||(e=o("I64"))).to_int32(i!=null?i:(e||(e=o("I64"))).zero)/1e3,file:a,isPtt:!0,plaintext:await o("WABlobToArrayBuffer").blobToArrayBuffer(a),type:"audio",waveform:l}});throw r("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no playableUrl for this audio attachment")}if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").STICKER))){if(l==null&&c==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no url for this sticker");return l!=null?c!=null?Promise.all([window.fetch(l).then(function(e){return e.blob()}),window.fetch(c).then(function(e){return e.blob()})]).then(function(e){var t=e[0],n=e[1],r=new File([t],"mediaForwardedFromOpenThread",{type:u}),o=new File([n],"previewForwardedFromOpenThread",{type:d});return p(r,o)}):window.fetch(l).then(function(e){return e.blob()}).then(function(e){var t=new File([e],"mediaForwardedFromOpenThread",{type:u});return p(t,t)}):window.fetch(c).then(function(e){return e.blob()}).then(function(e){return o("MAWImagePreProcess").imagePreprocess(new File([e],"previewForwardedFromOpenThread",{type:d}),!0)})}throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding other media types. Received attachment %d",(s||(s=o("LSIntEnum"))).toNumber(n))}function S(t,n,a,i,l,u,c,d,p){return o("MAWForwardMessage").maybeCreateNewThreadAndCallback(n,a,function(_,f){var g=o("MAWGetEphemeralSettings").getEphemeralSetting(_,a),y=f;return g.then(function(a){if(u!=null){if(m(u.attachmentFbid)){var f=o("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMsg",{args:{content:"\u{1F44D}",ephemeralSetting:a!=null?a:void 0,isFirstMsg:y,isForwarded:l,source:c,specialTextSize:1},chatJid:_,externalId:p,qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:d});return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:_,externalId:p},f,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:d},n)}return(e||(e=o("I64"))).equal(u.attachmentType,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))?h(t,u,n,d).then(function(e){var t=e.faviconFileArgs,l=e.headerFileArgs,s=e.previewFileArgs,u=e.xmaArgs,c=e.xmaMessageType,m=i.text,f=o("MAWBridgeSendAndReceive").sendAndReceive("backend","sendXMAShareMsg",{args:{content:m!=null&&o("MAWVault").isVaulted(m)?o("MAWVault").unvault(m):m,ephemeralSetting:a!=null?a:void 0,isFirstMsg:y,isForwarded:!0,xmaMessageType:c!=null?c:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE},chatJid:_,faviconFile:t,headerFile:l,previewFile:s,qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:d,xmaArgs:u,xmaMsgExternalId:p});return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:_,externalId:p},f,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:d},n)}):v(u).then(async function(e){var t,i;switch(e.type){case"image":{var s=e.imageSpec,u=e.thumbnailUrlAndSpec;i={args:{ephemeralSetting:a!=null?a:void 0,height:s.height,isFirstMsg:y,isForwarded:l,jpegThumbnail:u==null?void 0:u.jpegThumbnail,jpegThumbnailHeight:u==null?void 0:u.height,jpegThumbnailWidth:u==null?void 0:u.width,source:c,width:s.width},attachmentType:"image",chatJid:_,externalId:p};break}case"video":{var m=e.thumbnailUrlAndSpec;i={args:{duration:m.duration,ephemeralSetting:a!=null?a:void 0,height:m.height,isFirstMsg:y,isForwarded:l,jpegThumbnail:m.jpegThumbnail,jpegThumbnailHeight:m.height,jpegThumbnailWidth:m.width,source:c,width:m.width},attachmentType:"video",chatJid:_,externalId:p};break}case"audio":{var f=e.durations,g=e.isPtt,h=e.waveform;i={args:{duration:Math.round(f),ephemeralSetting:a!=null?a:void 0,isFirstMsg:y,isForwarded:l,isPtt:g,source:c,waveform:h},attachmentType:"audio",chatJid:_,externalId:p};break}case"document":{i={args:{ephemeralSetting:a!=null?a:void 0,filename:e.filename,isFirstMsg:y,isForwarded:l,source:c},attachmentType:"application",chatJid:_,externalId:p};break}}if(i==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this attachment type: %s",e.type);var C=o("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMediaMsgV2",babelHelpers.extends({},i,{mimeType:e.file.type,plaintext:(t=e.plaintext)!=null?t:await o("WABlobToArrayBuffer").blobToArrayBuffer(e.file),qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:d}));return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:_,externalId:p},C,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:d},n)})}var g=i.text;if(g!=null){var C=o("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMsg",{args:{content:o("MAWVault").isVaulted(g)?o("MAWVault").unvault(g):g,ephemeralSetting:a!=null?a:void 0,isFirstMsg:y,isForwarded:l,source:c},chatJid:_,externalId:p,qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:d});return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:_,externalId:p},C,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:d},n)}throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this types")})},d)}l.downloadMediaByUrl=v,l.forwardMessage=S}),98);
__d("LSLocalApplyOptimisticMessageWithAttachments",["LSArrayGetObjectAt","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.storedProcedure(n("LSLocalApplyOptimisticMessage"),e[0],e[1],e[2],e[3],e[4],e[5],e[6],void 0,e[7],e[8],e[9],e[10],void 0,e[12],!0).then(function(e){var t;return t=e,r[0]=t[0],r[1]=t[1],t})},function(o){return r[2]=t.i64.of_int32(e[11].length),t.i64.gt(r[2],t.i64.cast([0,0]))?t.loopAsync(r[2],function(o){return r[3]=o,t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[11],r[3]).then(function(e){var t;return t=e,r[4]=t[0],r[5]=t[1],t})},function(n){return r[6]=r[4].get("attachment_fbid"),r[7]=r[4].get("offline_attachment_id"),r[8]=r[4].get("attachment_type"),r[9]=r[4].get("filename"),r[10]=r[4].get("filesize"),r[11]=r[4].get("attachment_index"),r[12]=r[4].get("has_media"),r[13]=r[4].get("has_xma"),r[14]=r[4].get("playable_url"),r[15]=r[4].get("playable_url_mime_type"),r[16]=r[4].get("playable_duration_ms"),r[17]=r[4].get("preview_url"),r[18]=r[4].get("preview_url_mime_type"),r[19]=r[4].get("mini_preview"),r[20]=r[4].get("preview_width"),r[21]=r[4].get("preview_height"),r[22]=r[4].get("xma_layout_type"),r[23]=r[4].get("xmas_template_type"),r[24]=r[4].get("cta1_title"),r[25]=r[4].get("cta2_title"),r[26]=r[4].get("cta3_title"),r[27]=r[4].get("image_url"),r[28]=r[4].get("action_url"),r[29]=r[4].get("title_text"),r[30]=r[4].get("subtitle_text"),r[31]=r[4].get("description_text"),r[32]=r[4].get("source_text"),r[33]=r[4].get("original_file_hash"),r[34]=r[4].get("sound_bite_client_sound_key"),r[35]=r[4].get("sound_bite_visual"),r[36]=r[4].get("ephemeral_media_state"),r[37]=r[4].get("waveform_data"),r[38]=r[4].get("sampling_frequency_hz"),r[17]!==void 0?r[39]=r[17]:r[39]=r[14],t.filter(t.db.table(16).fetch([[[e[1],r[0],r[6]]]]),function(n){return t.i64.eq(n.threadKey,e[1])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&n.messageId===r[0]&&n.attachmentFbid===r[6]&&t.i64.gt(n.authorityLevel,t.i64.cast([0,20]))}).next().then(function(n){var o=n.done,a=n.value;return o?t.db.table(16).put({threadKey:e[1],messageId:r[0],attachmentFbid:r[6],timestampMs:r[1],offlineAttachmentId:r[7],attachmentType:r[8],filename:r[9],filesize:r[10],attachmentIndex:r[11],hasMedia:r[12],hasXma:r[13],isSharable:!1,playableUrl:r[14],playableUrlMimeType:r[15],playableDurationMs:r[16],previewUrl:r[39],previewUrlMimeType:r[18],miniPreview:r[19],previewWidth:r[20],previewHeight:r[21],xmaLayoutType:r[22],xmasTemplateType:r[23],cta1Title:r[24],cta2Title:r[25],cta3Title:r[26],imageUrl:r[27],actionUrl:r[28],titleText:r[29],subtitleText:r[30],descriptionText:r[31],sourceText:r[32],ephemeralMediaState:r[36],originalFileHash:r[33],authorityLevel:t.i64.cast([0,20]),samplingFrequencyHz:r[38],waveformData:r[37]}):0})}])}):t.resolve()},function(o){return r[2]=t.i64.of_int32(e[11].length),t.i64.gt(r[2],t.i64.cast([0,0]))?t.storedProcedure(n("LSSetMessageDisplayedContentTypes"),e[1],r[0],r[1],e[3],!1,t.i64.neq(e[6],void 0)):t.resolve()},function(e){var t;return t=[r[0],r[1]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxLocalApplyOptimisticMessageWithAttachmentsStoredProcedure",e.__tables__=["attachments"],a.exports=e}),null);
__d("LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure",["LSLocalApplyOptimisticMessageWithAttachments","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSLocalApplyOptimisticMessageWithAttachments"),a.senderId,a.threadKey,a.threadType,a.text,a.snippet,a.snippetHasEmoji,a.stickerId,a.replySourceId,a.replySourceType,a.replySourceTypeV2,a.isForwarded,a.attachments,a.mentionData);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptimisticSendXMAMessageForwardFromSecureThread",["LSArrayGetObjectAt","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes","LSUpdateOptimisticAttachmentPreview"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.storedProcedure(n("LSLocalApplyOptimisticMessage"),e[0],e[1],e[2],e[3],void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,3]),e[4],void 0,void 0,!0).then(function(e){var t;return t=e,r[0]=t[0],r[1]=t[1],t})},function(o){return r[3]=t.i64.of_int32(e[6].length),t.i64.gt(r[3],t.i64.cast([0,0]))?t.loopAsync(r[3],function(o){return r[4]=o,t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[6],r[4]).then(function(e){var t;return t=e,r[5]=t[0],r[6]=t[1],t})},function(o){return r[7]=r[5].get("attachment_fbid"),r[8]=r[5].get("offline_attachment_id"),r[9]=r[5].get("attachment_type"),r[10]=r[5].get("filename"),r[11]=r[5].get("filesize"),r[12]=r[5].get("attachment_index"),r[13]=r[5].get("has_media"),r[14]=r[5].get("has_xma"),r[15]=r[5].get("playable_url"),r[16]=r[5].get("playable_url_mime_type"),r[17]=r[5].get("playable_duration_ms"),r[18]=r[5].get("preview_url"),r[19]=r[5].get("preview_url_mime_type"),r[20]=r[5].get("mini_preview"),r[21]=r[5].get("preview_width"),r[22]=r[5].get("preview_height"),r[23]=r[5].get("xma_layout_type"),r[24]=r[5].get("xmas_template_type"),r[25]=r[5].get("cta1_title"),r[26]=r[5].get("cta2_title"),r[27]=r[5].get("cta3_title"),r[28]=r[5].get("image_url"),r[29]=r[5].get("action_url"),r[30]=r[5].get("title_text"),r[31]=r[5].get("subtitle_text"),r[32]=r[5].get("description_text"),r[33]=r[5].get("source_text"),r[34]=r[5].get("original_file_hash"),r[35]=r[5].get("sound_bite_client_sound_key"),r[36]=r[5].get("sound_bite_visual"),r[37]=r[5].get("ephemeral_media_state"),t.sequence([function(n){return t.forEach(t.filter(t.db.table(16).fetch([[[e[1],r[0],r[7]]]]),function(n){return t.i64.eq(n.threadKey,e[1])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&n.messageId===r[0]&&n.attachmentFbid===r[7]&&t.i64.lt(n.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(n){return t.db.table(16).add({threadKey:e[1],messageId:r[0],attachmentFbid:r[7],timestampMs:r[1],offlineAttachmentId:r[8],attachmentType:r[9],filename:r[10],filesize:r[11],attachmentIndex:r[12],hasMedia:r[13],hasXma:r[14],isSharable:!1,playableUrl:r[15],playableUrlMimeType:r[16],playableDurationMs:r[17],previewUrl:r[18],previewUrlMimeType:r[19],miniPreview:r[20],previewWidth:r[21],previewHeight:r[22],xmaLayoutType:r[23],xmasTemplateType:r[24],cta1Title:r[25],cta2Title:r[26],cta3Title:r[27],imageUrl:r[28],actionUrl:r[29],titleText:r[30],subtitleText:r[31],descriptionText:r[32],sourceText:r[33],ephemeralMediaState:r[37],originalFileHash:r[34],authorityLevel:t.i64.cast([0,20])})},function(o){return t.storedProcedure(n("LSSetMessageDisplayedContentTypes"),e[1],r[0],r[1],e[3],!1,!1)},function(o){return t.storedProcedure(n("LSUpdateOptimisticAttachmentPreview"),e[1],r[0],r[7],r[15],void 0,void 0,r[16],r[18],void 0,void 0,r[19],r[21],r[22],r[30])}])}])}):t.resolve()},function(o){return t.storedProcedure(n("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),t.i64.to_string(e[1]),t.i64.cast([0,46]),"",void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),t.i64.cast([0,1]),void 0,t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[2]=t[0],t})},function(n){return t.db.table(31).add({taskId:r[2],threadKey:e[1],offlineThreadingId:r[0],threadAttributionSource:e[5],sendType:t.i64.cast([0,11]),markThreadRead:!1})},function(e){return o[0]=r[0]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure",e.__tables__=["attachments","messages_optimistic_context"],a.exports=e}),null);
__d("LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure",["LSOptimisticSendXMAMessageForwardFromSecureThread","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticSendXMAMessageForwardFromSecureThread"),a.senderId,a.threadKey,a.threadType,a.text,a.isForwarded,a.source,a.attachments);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("MAWForwardMessageFromSecureThread.react",["FBLogger","I64","LSFactory","LSHotEmojiSize","LSInsertNewMediaSendStoredProcedure","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure","LSMailboxType","LSMarkSubJobCompletedV2StoredProcedure","LSOptimisticSendMessageV2StoredProcedure","LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure","LSShape","LSVec","MAWAudioUtils","MAWBridgeSendAndReceive","MAWDbMedia","MWPComposerMediaUploadUtil","MWPOpenComposerUtils","MessagePowerUp","MessagingAttachmentType","OfflineThreadingId","ReQL","WAHashUtils","cr:2472","cr:332","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,n,r){return{action_url:void 0,attachment_fbid:n,attachment_index:(e||(e=o("I64"))).zero,attachment_type:t.attachmentType,cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:t.filename,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:n,original_file_hash:void 0,playable_duration_ms:t.playableDurationMs,playable_url:URL.createObjectURL(r),playable_url_mime_type:r.type,preview_height:void 0,preview_url:void 0,preview_url_mime_type:void 0,preview_width:void 0,source_text:void 0,subtitle_text:void 0,title_text:void 0,waveform_data:t.waveformData,xma_layout_type:void 0,xmas_template_type:void 0}}function c(t,n,r,a){var i;return{action_url:(i=n==null?void 0:n.actionUrl)!=null?i:n==null?void 0:n.nativeUrl,attachment_fbid:r,attachment_index:(e||(e=o("I64"))).zero,attachment_type:t.attachmentType,cta1_title:t.cta1Title,cta2_title:t.cta2Title,cta3_title:t.cta3Title,description_text:t.descriptionText,filename:t.filename,filesize:t.filesize,has_media:!1,has_xma:!0,image_url:void 0,mini_preview:void 0,offline_attachment_id:r,original_file_hash:void 0,playable_duration_ms:void 0,playable_url:a!=null?URL.createObjectURL(a):void 0,playable_url_mime_type:a==null?void 0:a.type,preview_height:void 0,preview_url:a!=null?URL.createObjectURL(a):void 0,preview_url_mime_type:a==null?void 0:a.type,preview_width:void 0,source_text:t.sourceText,subtitle_text:t.subtitleText,title_text:t.titleText,xma_layout_type:t.xmaLayoutType,xmas_template_type:t.xmasTemplateType}}function d(e,t,n,a,i,l,s,u){var c=r("LSFactory")(u);return r("LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure")(c,{attachments:r("LSVec").ofArray([o("LSShape").ofRecord(l)]),isForwarded:i,senderId:e,source:s,text:a!=null?a:void 0,threadKey:t,threadType:n}).then(function(){return Promise.resolve()})}function m(e,t){if(t!=null)return{amplitudes:t.split(",").map(parseFloat),sampling_freq:e!=null?e:o("MAWAudioUtils").WAVEFORM_SAMPLE_RATE}}function p(t,n,a,l,u,c,d,p,_){var f=r("LSFactory")(p);return r("LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure")(f,{attachments:r("LSVec").ofArray([o("LSShape").ofRecord(n)]),isForwarded:c,senderId:d,threadKey:u,threadType:l}).then(function(t){var n=t[0],r=t[1];return p.messages_optimistic_context.add({externalAttachmentUrl:void 0,initiatingSource:void 0,markThreadRead:!1,messageId:void 0,offlineThreadingId:n,platformRef:void 0,platformToken:void 0,replySourceId:void 0,replySourceType:void 0,sendType:void 0,skipUrlPreviewGen:void 0,taskId:(e||(e=o("I64"))).of_string(n),threadAttributionSource:_,threadKey:u}).then(function(){return Promise.resolve(n)})}).then(function(t){var a=n.attachment_fbid;return r("LSInsertNewMediaSendStoredProcedure")(f,{attachmentType:n.attachment_type,inMessageIndex:(e||(e=o("I64"))).zero,isSecure:!1,offlineAttachmentId:a,offlineThreadingId:t,sendByServer:!1,shouldTranscode:!1,useDoublePhase:!1}).then(function(){return Promise.resolve([t,a])})}).then(function(l){var u=l[0],c=l[1],d=function(a,l){l==null||l.length===0||r("promiseDone")(t.runInTransaction(function(t){var n=r("LSFactory")(t);return r("LSMarkSubJobCompletedV2StoredProcedure")(n,{fbid:(e||(e=o("I64"))).of_string(l),offlineAttachmentId:c}).then(function(){return o("MWPOpenComposerUtils").resumeSendJob(n,u)})},"readwrite",void 0,void 0,i.id+":223"))};return o("MWPComposerMediaUploadUtil").startUpload(void 0,void 0,d,void 0,(e||(e=o("I64"))).equal(n.attachment_type,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO)),[a],[c],void 0,void 0,m(n.sampling_frequency_hz,n.waveform_data),void 0,void 0)})}async function _(t,a,l,_,f,g,h,y,C){if(g!=null){var b=g.attachmentType;if(!((e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO))||(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))||(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO))||(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE))||(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE))||(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))))throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type");var v=null;if(!(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))&&(isFinite(g.attachmentFbid)?v=await o("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByMediaId",{description:"MAWForwardMessageFromSecureThread",mediaId:o("MAWDbMedia").convertNumberToMediaId(Number.parseInt(g.attachmentFbid,10))}):v=await o("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByHashedPlaintextHash",{description:"MAWForwardMessageFromSecureThread",plaintextHash:o("WAHashUtils").stringToPlaintextHash(g.attachmentFbid)}).then(function(e){return n("cr:332")!=null&&n("cr:332").runBlobReadAndCompareResult({fileName:g.attachmentFbid,idbBlob:e}),e}),v==null))return;await t.runInTransaction(function(i){switch(!0){case(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO)):{var S;if(v==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("Blob can not be null for MessagingAttachmentType.AUDIO");var R=new File([v],"mediaForwardedFromSecureThread",{type:v.type}),L=o("OfflineThreadingId").createOfflineThreadingID(),E=o("MWPComposerMediaUploadUtil").getAudioAttachment(L,R,(e||(e=o("I64"))).to_int32((S=g.playableDurationMs)!=null?S:(e||(e=o("I64"))).zero)/1e3,m(g.samplingFrequencyHz!=null?(e||(e=o("I64"))).to_int32(g.samplingFrequencyHz):void 0,g.waveformData));return p(t,E,R,l,a,f,h,i,y)}case(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA)):{var k;return o("ReQL").firstAsync(o("ReQL").fromTableDescending(i.attachment_ctas).getKeyRange((k=g.defaultCtaId)!=null?k:(e||(e=o("I64"))).zero)).then(function(e){var t=g.xmaPreviewFbid;if(t==null)return r("FBLogger")("messenger_web_sharing").mustfix("XMA preview fbid is null when forwarding XMA"),Promise.resolve([e,void 0]);var a=o("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByHashedPlaintextHash",{description:"MAWForwardMessageFromSecureThread",plaintextHash:o("WAHashUtils").stringToPlaintextHash(t)}).then(function(e){return n("cr:332")!=null&&n("cr:332").runBlobReadAndCompareResult({fileName:g.attachmentFbid,idbBlob:e}),e});return a.then(function(t){return Promise.resolve([e,t])}).catch(function(t){return r("FBLogger")("messenger_web_sharing").catching(t).warn("Unable to getBlobDataUrlByXMAId, from MAWForwardMessageFromSecureThread"),Promise.resolve([e,void 0])})}).then(function(e){var t=e[0],r=e[1],s=null;r!=null&&(s=new File([r],"xmaForwardedFromSecureThread",{type:r.type}));var u=o("OfflineThreadingId").createOfflineThreadingID(),m=c(g,t,u,s),p=_.text,b=n("cr:2472")==null||p==null?p:n("cr:2472").unvault(p);return d(h,a,l,C!=null?C:b,f,m,y,i)})}case(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE)):case(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE)):case(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO)):case(e||(e=o("I64"))).equal(b,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE)):{var I;if(v==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("Blob can not be null for MessagingAttachmentType.AUDIO");var T=new File([v],(I=g.filename)!=null?I:"mediaForwardedFromSecureThread",{type:v.type}),D=o("OfflineThreadingId").createOfflineThreadingID(),x=u(g,D,T);return p(t,x,T,l,a,f,h,i,y)}default:throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type")}},"readwrite",void 0,void 0,i.id+":338")}else{var S=_.text;if(S==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type");var R=n("cr:2472")==null?S:n("cr:2472").unvault(S),L=R==="\u{1F44D}"&&_.hotEmojiSize!=null&&(e||(e=o("I64"))).equal(_.hotEmojiSize,(s||(s=o("LSIntEnum"))).ofNumber(r("LSHotEmojiSize").SMALL)),E=L?(e||(e=o("I64"))).of_string("369239263222822"):void 0;await t.runInTransaction(function(e){return r("LSOptimisticSendMessageV2StoredProcedure")(r("LSFactory")(e),{extraSendMessageParams:o("LSShape").ofRecord({calculate_denormalizations:!1,is_forwarded:f,mark_read:!1,power_up_style:(s||(s=o("LSIntEnum"))).ofNumber(r("MessagePowerUp").NONE),source:y,sticker_id:E}),mailboxType:s.ofNumber(r("LSMailboxType").MESSENGER),senderId:h,text:L?void 0:C!=null?C:R,threadKey:a,threadType:l})},"readwrite",void 0,void 0,i.id+":526")}}l.getMediaAttachment=u,l.uploadAndSendMediaToOpenThread=p,l.forwardMessage=_}),98);
__d("forwardAttachmentCollectionToOpen",["I64","LSFactory","LSIntEnum","LSOptimisticSendMessageForwardStoredProcedure","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachmentCollectionToOpen");async function c(t,n,a,i,l){var c=await u.load(),d=await c(),m=await d.runInTransaction(function(u){return r("LSOptimisticSendMessageForwardStoredProcedure")(r("LSFactory")(u),{forwardedMsgId:t.messageId,forwardedMsgThreadKey:t.threadKey,forwardedMsgTimestampMs:t.timestampMs,initiatingSource:void 0,senderId:i,source:l,threadKey:(e||(e=o("I64"))).of_string(n),threadType:(s||(s=o("LSIntEnum"))).ofNumber(a)})},"readwrite"),p=m[0];return p}l.default=c}),98);
__d("forwardXMAFromInstamadillo",["requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("requireDeferred")("getSendPostToInstamadilloRecipient").__setRef("forwardXMAFromInstamadillo"),s=r("requireDeferred")("getSendProfileToInstamadilloRecipient").__setRef("forwardXMAFromInstamadillo"),u=r("requireDeferred")("getSendReelToInstamadilloRecipient").__setRef("forwardXMAFromInstamadillo");async function c(t,n,r,o){if(n!=null){var a=JSON.parse(n);switch(a.__typename){case"XMSGIgReceiverFetchXmaFeedFetchParams":{var i=await e.load(),l=i(a.media_igid,void 0,r,o,!0);await l(t.id,t.isDisappearingModeSettingOn,t.isTTLCMediaShareEnabled);break}case"XMSGIgReceiverFetchXmaClipFetchParams":{var c=await u.load(),d=c(a.media_igid,void 0,r,o,!0);await d(t.id,t.isDisappearingModeSettingOn,t.isTTLCMediaShareEnabled);break}case"XMSGIgReceiverFetchXmaProfileFetchParams":{var m=await s.load(),p=m(a.igid,void 0,r,o,!0);await p(t.id,t.isDisappearingModeSettingOn,t.isTTLCGenericXMAShareEnabled);break}}}}l.default=c}),98);
__d("forwardXMAUtils",["FBLogger","IGDInstamadilloUtils","IGDThreadTTLCUtils","URI","getErrorSafe","isLinkshimURI"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=new(e||(e=r("URI")))(t);return r("isLinkshimURI")(n)&&(n=new(e||(e=r("URI")))(n.getQueryData().u)),n.toString()}function u(e,t){return e==="igd_web_post_share"&&t.includes("instagram.com/p/")}function c(e,t){return e==="xma_open_native"&&t.includes("https://www.instagram.com")}function d(e,t,n,a){if(e==null)return!1;var i=o("IGDInstamadilloUtils").isInstamadilloMessage(t);if(i&&t.xmaReceiverFetchParams!=null){var l;try{l=JSON.parse(t.xmaReceiverFetchParams)}catch(e){return r("FBLogger")("igd_web").mustfix("forwardXMAUtils: failed to parse message xmaReceiverFetchParams with error %s.",r("getErrorSafe")(e).message),!1}return o("IGDThreadTTLCUtils").isXmaReceiverFetchTTLCEnabled(l,e)}if(a==null||(a==null?void 0:a.actionUrl)==null)return!1;var d=s(a.actionUrl);return u(n==null?void 0:n.defaultCtaType,d)?o("IGDThreadTTLCUtils").isInstamadilloTTLCMediaShareEnabled(e):c(n==null?void 0:n.defaultCtaType,d)?o("IGDThreadTTLCUtils").isInstamadilloTTLCGenericXmaEnabled(e):!1}l.linkshimDecode=s,l.isFeedXma=u,l.isProfileXma=c,l.shouldForwardXMAViaTTLC=d}),98);
__d("forwardXMAFromOpenToInstamadillo",["FBLogger","I64","PolarisDirectAPI","PolarisLinkshimURI","URI","forwardXMAUtils","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("getSendPostToInstamadilloRecipient").__setRef("forwardXMAFromOpenToInstamadillo"),c=r("requireDeferred")("getSendProfileToInstamadilloRecipient").__setRef("forwardXMAFromOpenToInstamadillo"),d=function(t){var e=new(s||(s=r("URI")))(t);return o("PolarisLinkshimURI").shouldSkipLinkShim(t)&&(e=new(s||(s=r("URI")))(e.getQueryData().u)),e.toString()};async function m(t,n,a,i,l,s){var m=d(l);if(o("forwardXMAUtils").isFeedXma(n.defaultCtaType,m)&&a!=null){var p=await u.load(),_=p((e||(e=o("I64"))).to_string(a),void 0,i,m,!0);await _(t.id,t.isDisappearingModeSettingOn,s)}if(o("forwardXMAUtils").isProfileXma(n.defaultCtaType,m)){if(i==null)return;try{var f=await o("PolarisDirectAPI").getUserProfile(i);if(f.status==="ok"){var g,h,y=(g=f.data)==null||(g=g.user)==null?void 0:g.id,C=(h=f.data)==null||(h=h.user)==null?void 0:h.eimu_id;if(y!=null&&C!=null){var b=await c.load(),v=b(y,C,i,m,!0);await v(t.id,t.isDisappearingModeSettingOn,s)}}}catch(e){r("FBLogger")("igd_web").mustfix("forwardXMAFromOpenToInstamadillo: failed to call getUserProfile Django API",String(e));return}}}l.default=m}),98);
__d("MWChatThreadId",["FBLogger","I64","LSIntEnum"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e){switch(e.NAME){case"Group":case"User":case"Page":case"UserSecret":return e.VAL}}function c(e){switch(e.NAME){case"Group":return"g."+e.VAL;case"Page":return"p."+e.VAL;case"User":return"u."+e.VAL;case"UserSecret":throw r("FBLogger")("messenger_web").mustfixThrow("MWChatThreadIdType Not supported")}}function d(e){switch(e.targetType){case"GROUP":return{NAME:"Group",VAL:e.targetID};case"PAGE":return{NAME:"Page",VAL:e.targetID};case"USER":return{NAME:"User",VAL:e.targetID};default:throw r("FBLogger")("messenger_web").mustfixThrow("Invalid id")}}function m(e){return e.NAME==="User"}function p(e){return e.NAME==="UserSecret"}function _(e){if(e!=null){var t=e.split(":");if(t.length===2){var n=t[0],r=t[1];switch(n){case"thread":return{NAME:"Group",VAL:r};case"user":return{NAME:"User",VAL:r};default:return}}}}function f(t){var n=t.NAME;return n==="Group"?(e||(e=o("LSIntEnum"))).ofNumber(2):n==="User"||n==="Page"?(e||(e=o("LSIntEnum"))).ofNumber(1):(e||(e=o("LSIntEnum"))).ofNumber(7)}function g(e){return(s||(s=o("I64"))).of_string(e.VAL)}l.getFBID=u,l.serializeFuture=c,l.fromJs=d,l.isUser=m,l.isSecret=p,l.deserializeFromLegacyThreadId=_,l.getMessagingThreadType=f,l.toThreadKey=g}),98);
__d("WorkChatMessageType",[],(function(t,n,r,o,a,i){"use strict";var e="text",l="gif",s="sticker",u="audio",c="file",d="hotEmoji";i.text=e,i.gif=l,i.sticker=s,i.audio=u,i.file=c,i.hotEmoji=d}),66);
__d("useMWLSSendStickerMessage",["I64","Int64Hooks","LSFactory","LSIntEnum","LSMailboxType","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSOptimisticSendMessageV2StoredProcedure","LSShape","LSThreadAttributionTypeUtil","MWPActor.react","MessagePowerUp","WorkChatMessageType","promiseDone","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(t,n,a){var l=(u||(u=r("useReStore")))(),c=o("MWPActor.react").useActor();return o("Int64Hooks").useCallbackInt64(function(u,d,m){r("promiseDone")(l.runInTransaction(function(a){var i=o("LSThreadAttributionTypeUtil").getSourceAndResetAttribution(u,t!=null?t:"unknown");return r("LSOptimisticSendMessageV2StoredProcedure")(r("LSFactory")(a),{extraSendMessageParams:o("LSShape").ofRecord({calculate_denormalizations:!0,initiating_source:n,mark_read:!0,optimistic_attachment_preview:o("LSShape").ofRecord({playable_url:void 0,playable_url_expiration_timestamp_ms:void 0,playable_url_fallback:void 0,playable_url_mime_type:void 0,preview_height:(e||(e=o("I64"))).zero,preview_url:m,preview_url_expiration_timestamp_ms:void 0,preview_url_fallback:void 0,preview_url_mime_type:void 0,preview_width:e.zero}),power_up_style:(s||(s=o("LSIntEnum"))).ofNumber(r("MessagePowerUp").NONE),reply_source_id:void 0,reply_source_type:s.ofNumber(r("LSMessageReplySourceType").MESSAGE),reply_source_type_v2:s.ofNumber(r("LSMessageReplySourceTypeV2").MESSAGE),snippet_has_emoji:!1,source:i,sticker_id:e.of_string(d)}),mailboxType:s.ofNumber(r("LSMailboxType").MESSENGER),senderId:c,threadKey:u,threadType:s.ofNumber(1)})},"readwrite",void 0,void 0,i.id+":49").then(function(e){a==null||a(o("WorkChatMessageType").sticker,1,e[0])}))},[l,c,n,t,a])}l.default=c}),98);
__d("MWLSForwardMessage",["I64","Int64Hooks","LSFactory","LSMediaUrlAttachment","LSOptimisticSendAttachmentForwardStoredProcedure","LSOptimisticSendMessageForwardStoredProcedure","MWChatThreadId","MWPActor.react","ODS","Promise","ReQL","promiseDone","useGetForwardSource","useLSMessagingInitiatingSource","useLSMessagingSource","useMWLSSendStickerMessage","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c;function d(){var t=(c||(c=r("useReStore")))(),a=o("MWPActor.react").useActor(),l=r("useLSMessagingInitiatingSource")(),d=r("useGetForwardSource")(),m=r("useLSMessagingSource")(),p=r("useMWLSSendStickerMessage")(m,l);return o("Int64Hooks").useCallbackInt64(function(c,m,_){if(_.type==="sent"){var f=_.value,g=f.timestamp,h=f.messageId,y=f.threadId;(s||(s=o("ODS"))).bumpEntityKey(3185,"mw_forward","send");var C=function(){return t.runInTransaction(function(e){return r("LSOptimisticSendMessageForwardStoredProcedure")(r("LSFactory")(e),{forwardedMsgId:h,forwardedMsgThreadKey:y,forwardedMsgTimestampMs:g,initiatingSource:l,senderId:a,source:d,threadKey:c,threadType:m})},"readwrite",void 0,void 0,i.id+":62").then(function(){})};r("promiseDone")(o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.messages).getKeyRange(y,g,h)).then(function(r){if(r==null)return C();var a=r.stickerId;return a!=null?o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.attachments).getKeyRange(y,h)).then(function(t){var r=t!=null?o("LSMediaUrlAttachment").previewUrl(t):void 0;return p(c,(u||(u=o("I64"))).to_string(a),r),(e||(e=n("Promise"))).resolve()}):C()}),function(){return(s||(s=o("ODS"))).bumpEntityKey(3185,"mw_forward","success")},function(){return(s||(s=o("ODS"))).bumpEntityKey(3185,"mw_forward","failure")})}},[t,a,l,d,p])}function m(){var e=(c||(c=r("useReStore")))(),t=o("MWPActor.react").useActor(),n=r("useLSMessagingInitiatingSource")(),a=r("useGetForwardSource")();return o("Int64Hooks").useMemoInt64(function(){return(function(l,c,d){(s||(s=o("ODS"))).bumpEntityKey(3185,"mw_forward","send");var m=o("MWChatThreadId").getMessagingThreadType(l),p=o("MWChatThreadId").toThreadKey(l);r("promiseDone")(e.runInTransaction(function(e){return r("LSOptimisticSendAttachmentForwardStoredProcedure")(r("LSFactory")(e),{forwardedAttachmentFbid:(u||(u=o("I64"))).of_string(c),initiatingSource:n,senderId:t,source:a,threadKey:p,threadType:m})},"readwrite",void 0,void 0,i.id+":140"),function(){return(s||(s=o("ODS"))).bumpEntityKey(3185,"mw_forward","success")},function(){return(s||(s=o("ODS"))).bumpEntityKey(3185,"mw_forward","failure")})})},[e,t,n,a])}l.useForwardMessage=d,l.useForwardAttachment=m}),98);
__d("useMWV2ForwardMessage",["$InternalEnum","CometRelay","FBLogger","I64","Int64Hooks","LSIntEnum","LSMessagingThreadTypeUtil","MAWDbMsg","MAWExternalId","MAWThreadId","MAWVault","MAWVerifyThreadCutover","MWChatMessageId","MWChatThreadId","MWLSForwardMessage","MWMediaRenderQplUtils","MWPActor.react","MWSharedMsgLogUtils","MWSharedS2SBaseAnnotations","MWUnvaultedText","ReQL","ReQLSuspense","WAResultOrError","cr:19816","cr:19893","cr:19894","cr:9759","getErrorSafe","promiseDone","react","sendToSentQPLLogger","useGetForwardSource","useIsSecureMessage","useReStore","useStringWithSubstitutions"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=(s||(s=o("react"))).useMemo;function m(e,t,n){var r;return(r=o("ReQL")).firstAsync(r.mergeJoin(r.fromTableAscending(e.tables.participants).getKeyRange(t),r.fromTableAscending(e.tables.contacts)).filter(function(e){var t=e[0],r=e[1];return!(c||(c=o("I64"))).equal(r.id,n)}))}function p(e,t,n){var r=t.messageId,a=t.threadKey,l=o("ReQLSuspense").useArray(function(){return o("ReQL").fromTableAscending(e.tables.attachments).getKeyRange(a,r)},[e,r,a],i.id+":90"),s=o("ReQLSuspense").useFirst(function(){return n!=null?o("ReQL").fromTableAscending(e.tables.attachments).getKeyRange(a,r,n):o("ReQL").empty()},[n,e,r,a],i.id+":99"),u=l.length>0?l[0]:void 0;if(n!=null){var c=s!=null?s:u;return c!=null?[c]:[]}return l}function _(){var t=(e||(e=r("useReStore")))();return o("Int64Hooks").useCallbackInt64(async function(e,a,i,l,s,u,c,d,p){var _=o("MWChatThreadId").toThreadKey(s),g=o("MWChatThreadId").getMessagingThreadType(s),h=await o("MAWVerifyThreadCutover").verifyThreadCutover(Promise.resolve(t),_),y=await Promise.all([o("MAWThreadId").isSecureThreadKey(t.tables,_),o("MAWThreadId").getThread(t.tables,_),m(t,_,i)]),C=y[0],b=y[1],v=y[2],S=C||h;try{if(n("cr:19893")!=null&&!S)return o("sendToSentQPLLogger").addSendToSentAnnotations(u,{string:{forward_type:f.SecureToOpen}}),d!=null?await Promise.allSettled([d.messagesAndAttachments.map(function(e){var r;return n("cr:19893").forwardMessage(t,_,g,e.message,l,(r=e.attachment)!=null?r:void 0,i,c)})]):await n("cr:19893").forwardMessage(t,_,g,e,l,a[0],i,c,p),o("sendToSentQPLLogger").markSendToSentSuccess(u),[o("WAResultOrError").makeResult({description:"open message",messageType:"fixMe"})];var R=o("MAWDbMsg").toMsgId(e.messageId);if(R==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("Message does not have an id");if(n("cr:19816")!=null){o("sendToSentQPLLogger").addSendToSentAnnotations(u,{string:{forward_type:f.SecureToSecure}});var L;if(d!=null){var E=d.messagesAndAttachments.map(function(e){return o("MAWDbMsg").toMsgId(e.message.messageId)}).filter(Boolean);L=await n("cr:19816").forwardMessageBatch(t,_,E,c,u)}else L=await n("cr:19816").forwardMessage(t,_,R,c,u,p!=null?o("MAWVault").vault(p):void 0).then(function(e){return[e]});return n("cr:9759")!=null&&b!=null&&await n("cr:9759")(t,b,v,o("LSMessagingThreadTypeUtil").isOneToOne(b.threadType)),L!=null?L:[o("WAResultOrError").makeResult({description:"removal pending rollout of MAWMessageSendReporterV2",messageType:"fixMe"})]}throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We won't reach to this step, if you are in QE, you should use secure forward")}catch(e){var k=r("getErrorSafe")(e);throw o("sendToSentQPLLogger").markSendToSentFail(u,"failed_forwarding_message",k),r("FBLogger")("messenger_web").catching(k).mustfix("MW Fail forwarding a message"),k}},[t])}var f=n("$InternalEnum")({SecureToOpen:"secure_to_open",OpenToOpen:"open_to_open",SecureToSecure:"secure_to_secure",OpenToSecure:"open_to_secure"});function g(t,a,i,l){var s,g=(e||(e=r("useReStore")))(),h=p(g,t,i),y=r("useIsSecureMessage")(g,t,{fallbackThreadType:a}),C=o("MWPActor.react").useActor(),b=!(c||(c=o("I64"))).equal(C,t.senderId),v=o("MWLSForwardMessage").useForwardMessage(),S=o("MWLSForwardMessage").useForwardAttachment(),R=r("useGetForwardSource")(),L=o("MWChatMessageId").makeSent(c.to_string(t.threadKey),t.messageId,c.to_string(t.timestampMs)),E=o("CometRelay").useRelayEnvironment(),k=_(),I=o("MWSharedMsgLogUtils").getMessageTypeFromDisplayedContentType(t.displayedContentTypes),T=h.length>0?o("MWMediaRenderQplUtils").deriveMessageContentTypeStringFromAttachmentTypeLessAccurate(h[0].attachmentType):"NO_ATTACHMENT",D=d(function(){var e,n;return new Set((e=(n=t.mentionIds)==null||n.split==null?void 0:n.split(","))!=null?e:[])},[t.mentionIds]),x=D.size>0,$=o("MWUnvaultedText").useMWUnvaultedText(!1,t.text),P=(s=o("useStringWithSubstitutions").useStringWithMentionSubstitutionsAndUpdatedRanges(y?$:null,[],D,t.threadKey))!=null?s:{textWithSubstitutions:$},N=P.textWithSubstitutions,M=o("Int64Hooks").useCallbackInt64(async function(e){var n=o("MWChatThreadId").toThreadKey(e),r=await o("MAWThreadId").getThread(g.tables,n),a=function(r){return k(t,h,C,b,e,r,R,l,x?N:void 0)},i=o("sendToSentQPLLogger").markSendToSentStartWithAnnotation(r,{isForward:!0,mediaGroupInfo:l,numberOfAttachments:h.length},(u||(u=o("LSIntEnum"))).unwrapIntEnum(R),{string:{attachment_type:"forward",message_content_type_from_attachment:T,message_type:I}});await a(i)},[g.tables,l,h,R,T,I,k,t,C,b,x,N]),w=o("Int64Hooks").useCallbackInt64(async function(e){var a=o("MWChatThreadId").toThreadKey(e),l=o("MWChatThreadId").getMessagingThreadType(e),s=await Promise.all([o("MAWThreadId").isSecureThreadKey(g.tables,a),o("MAWThreadId").getThread(g.tables,a),m(g,a,C),o("MAWVerifyThreadCutover").verifyThreadCutover(Promise.resolve(g),a),o("MAWThreadId").getThread(g.tables,a)]),c=s[0],d=s[1],p=s[2],_=s[3],y=s[4],k=c||_,D=function(t,n){n===void 0&&(n=0);var e=o("sendToSentQPLLogger").markSendToSentStart();if(y!=null){var a=o("MWSharedS2SBaseAnnotations").getMessageTypeParams({isForward:!0,numberOfAttachments:n,threadType:y.threadType});r("promiseDone")(o("MWSharedMsgLogUtils").getSendToSentAnnotations({attachmentTypeParams:a,messageOfflineThreadingId:t,source:(u||(u=o("LSIntEnum"))).unwrapIntEnum(R),thread:y}),function(t){t.string=babelHelpers.extends({},t.string,{attachment_type:"forward",message_content_type_from_attachment:T,message_type:I}),o("sendToSentQPLLogger").addSendToSentAnnotations(e,t)})}return o("sendToSentQPLLogger").addSendToSentAnnotations(e,{string:{forward_type:f.OpenToSecure,message_content_type_from_attachment:T,message_type:I}}),e};if(n("cr:19894")!=null&&k){var x=function(r,o){return(function(e){return n("cr:19894").forwardMessage(E,g,a,t,b,o,R,e!=null?e:void 0,r).then(function(e){return[e]})})};if(h.length===0){var $=o("MAWExternalId").generateExternalId(),P=D($);await x($,void 0)(P),o("sendToSentQPLLogger").markSendToSentSuccess(P)}else await Promise.all(h.map(async function(e){var t=o("MAWExternalId").generateExternalId(),n=D(t,1);try{await x(t,e)(n),o("sendToSentQPLLogger").markSendToSentSuccess(n)}catch(e){var a=r("getErrorSafe")(e);throw o("sendToSentQPLLogger").markSendToSentFail(n,"failed_forwarding_message",a),r("FBLogger")("messenger_web").catching(a).mustfix("MW Fail forwarding a message"),a}}));n("cr:9759")!=null&&d!=null&&n("cr:9759")(g,d,p,o("LSMessagingThreadTypeUtil").isOneToOne(d.threadType))}else if(!k){var N=D(void 0,h.length);try{o("sendToSentQPLLogger").addSendToSentAnnotations(N,{string:{forward_type:f.OpenToOpen,message_content_type_from_attachment:T,message_type:I}}),i==null?v(a,l,L):S(e,i),o("sendToSentQPLLogger").markSendToSentSuccess(N);return}catch(e){var M=r("getErrorSafe")(e);throw o("sendToSentQPLLogger").markSendToSentFail(N,"failed_forwarding_message",M),r("FBLogger")("messenger_web").catching(M).mustfix("MW Fail forwarding a message"),M}}},[g,C,T,I,h,R,E,t,b,i,v,L,S]);return o("Int64Hooks").useMemoInt64(function(){return y?M:w},[y,M,w])}l.ForwardType=f,l.useMWV2ForwardMessage=g}),98);
__d("forwardXMA",["I64","IGDInstamadilloUtils","forwardText","forwardXMAFromInstamadillo","forwardXMAFromOpenToInstamadillo","forwardXMAOpenToOpen","forwardXMAUtils","requireDeferred","sendToSentQPLLogger","useMWV2ForwardMessage"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardXMA");async function u(t,n,a,i,l,u,c,d){var m,p=n.defaultCtaId;if(p!=null){var _=await s.load(),f=await _(),g=await f.tables.attachment_ctas.get(p),h=(m=n.headerTitle)!=null?m:n.titleText,y=g==null?void 0:g.actionUrl,C=g==null?void 0:g.targetId;if(y!=null){var b=await f.tables.threads.get((e||(e=o("I64"))).of_string(c.id)),v=o("forwardXMAUtils").shouldForwardXMAViaTTLC(b,t,n,g),S=c.isInstamadilloCutover||c.isDisappearingModeSettingOn||v,R=o("IGDInstamadilloUtils").isInstamadilloMessage(t)?S?o("useMWV2ForwardMessage").ForwardType.SecureToSecure:o("useMWV2ForwardMessage").ForwardType.SecureToOpen:S?o("useMWV2ForwardMessage").ForwardType.OpenToSecure:o("useMWV2ForwardMessage").ForwardType.OpenToOpen;switch(o("sendToSentQPLLogger").addSendToSentAnnotations(d,{bool:{use_instamadillo_transport:S,use_open_eb:v}}),R){case o("useMWV2ForwardMessage").ForwardType.OpenToSecure:return r("forwardXMAFromOpenToInstamadillo")(c,n,C,h,y,v);case o("useMWV2ForwardMessage").ForwardType.SecureToSecure:return r("forwardXMAFromInstamadillo")(c,t.xmaReceiverFetchParams,h,y);case o("useMWV2ForwardMessage").ForwardType.SecureToOpen:return r("forwardText")(y,a,i,l,u);case o("useMWV2ForwardMessage").ForwardType.OpenToOpen:return r("forwardXMAOpenToOpen")(t.messageId,a,i,l,u,(e||(e=o("I64"))).to_string(t.threadKey),(e||(e=o("I64"))).to_string(t.timestampMs))}}}}l.default=u}),98);
__d("sendIGDOptimisticRichContentMessage",["fbt","EntMessageReplyType","I64","LSAuthorityLevel","LSIntEnum","LSMessageHiddenState","LSMessageRenderingType","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSMessageSendStatus","LSQuickReplyType","LSReplyMessageStatus","MNLSXMALayoutType","MNLSXMATemplateType","PolarisDirectStrings","ReQL"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u;async function c(t,n,a,l,c,d,m,p,_,f,g,h,y,C,b,v){y===void 0&&(y=!0);var S={authorityLevel:(e||(e=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").OPTIMISTIC),displayedContentTypes:c,hasQuickReplies:!1,isAdminMessage:!1,isCollapsed:!1,isExpired:!1,isUnsent:!1,messageHiddenState:e.ofNumber(r("LSMessageHiddenState").NOT_HIDDEN),messageId:l,messageRenderingType:e.ofNumber(r("LSMessageRenderingType").DEFAULT),offlineThreadingId:l,primarySortKey:m,quickReplyType:e.ofNumber(r("LSQuickReplyType").NONE),replyMessageHiddenState:e.ofNumber(r("LSMessageHiddenState").NOT_HIDDEN),senderId:d,sendStatus:e.ofNumber(r("LSMessageSendStatus").SENDING_TO_SERVER),sendStatusV2:e.ofNumber(1),textHasLinks:!1,threadKey:p,timestampMs:m,transportKey:"FBBroker",viewFlags:e.ofNumber(0)};if(h!=null){var R=await t.runInTransaction(async function(e){var n,r=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.messages.index("messageId")).getKeyRange(h.messageId)),a=r!=null?await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.contacts).getKeyRange(r==null?void 0:r.senderId)):null;return{recipientName:a!=null&&(u||(u=o("I64"))).equal(a==null?void 0:a.id,d)?"yourself":a==null?void 0:a.name,replyMessageText:(n=r==null?void 0:r.text)!=null?n:""}},"readonly",void 0,void 0,i.id+":93"),L=R.recipientName,E=R.replyMessageText;S=babelHelpers.extends({},S,{replyMessageText:E,replySnippet:L!=null?o("PolarisDirectStrings").youRepliedToUser(L).toString():s._(/*BTDS*/"You replied to Instagram User").toString(),replySourceId:h.messageId,replySourceType:(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessageReplySourceType").MESSAGE),replySourceTypeV2:e.ofNumber(r("LSMessageReplySourceTypeV2").MESSAGE),replyStatus:e.ofNumber(r("LSReplyMessageStatus").VALID),replyToUserId:p,replyType:e.ofNumber(r("EntMessageReplyType").REGULAR)})}else if(v!=null){var k,I,T,D;S=babelHelpers.extends({},S,{replyMessageText:(k=(I=v.message.content)==null?void 0:I.text_body)!=null?k:"",replySnippet:((T=v.sender)==null?void 0:T.username)!=null?o("PolarisDirectStrings").youRepliedToUser((D=v.sender)==null?void 0:D.username).toString():s._(/*BTDS*/"You replied to Instagram User").toString(),replySourceId:v.message.message_id,replySourceType:(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessageReplySourceType").MESSAGE),replySourceTypeV2:e.ofNumber(r("LSMessageReplySourceTypeV2").MESSAGE),replyStatus:e.ofNumber(r("LSReplyMessageStatus").VALID),replyToUserId:p,replyType:e.ofNumber(r("EntMessageReplyType").REGULAR)})}var x={attachmentFbid:l,attachmentIndex:(u||(u=o("I64"))).zero,attachmentType:e.ofNumber(_),authorityLevel:e.ofNumber(r("LSAuthorityLevel").OPTIMISTIC),hasMedia:!1,hasXma:!1,imageUrl:f,isSharable:!1,messageId:l,playableUrl:f,previewHeight:n,previewUrl:f,previewUrlFallback:f,previewWidth:a,threadKey:p,timestampMs:m,transportKey:"FBBroker"},$=babelHelpers.extends({},x);switch(g){case"cutout_sticker":$=babelHelpers.extends({},x,{hasXma:!0,stickerType:"cutout_sticker",xmaLayoutType:(e||(e=o("LSIntEnum"))).ofNumber(r("MNLSXMALayoutType").SINGLE),xmasTemplateType:(e||(e=o("LSIntEnum"))).ofNumber(r("MNLSXMATemplateType").GENERIC_SHARE)});break;case"first_party_sticker":$=babelHelpers.extends({},x,{hasMedia:!0});break;case"avatar_sticker":$=babelHelpers.extends({},x,{hasXma:!0,stickerType:"avatar_sticker",xmaLayoutType:(e||(e=o("LSIntEnum"))).ofNumber(r("MNLSXMALayoutType").SINGLE),xmasTemplateType:(e||(e=o("LSIntEnum"))).ofNumber(r("MNLSXMATemplateType").GENERIC_SHARE)});break;case"third_party":$=babelHelpers.extends({},x,{hasMedia:!1,playableUrlMimeType:y?"image/gif":"image/jpeg"});break;case"music_sticker":$=babelHelpers.extends({},x,{hasXma:!0,stickerType:"music_sticker",subtitleText:b,titleText:C,xmaLayoutType:(e||(e=o("LSIntEnum"))).ofNumber(r("MNLSXMALayoutType").SINGLE),xmasTemplateType:(e||(e=o("LSIntEnum"))).ofNumber(r("MNLSXMATemplateType").GENERIC_SHARE)})}return t.runInTransaction(async function(e){await e.messages.put(S),await e.attachments.put($)},"readwrite",void 0,void 0,i.id+":225")}l.default=c}),226);
__d("useIGDForwardMessage",["FBLogger","I64","IGDThreadTTLCUtils","LSBitFlag","LSIntEnum","MWPActor.react","MercuryLocalIDs","MessagingAttachmentType","PolarisDirectAPI","PolarisDirectConstants","ReQL","forwardAttachment","forwardAttachmentCollectionToOpen","forwardAttachmentToOpen","forwardText","forwardXMA","getErrorSafe","qex","react-compiler-runtime","sendIGDOptimisticRichContentMessage","sendToSentQPLLogger","useAsyncReStore","useGetForwardSource"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("qex")._("41")===!0;async function c(t,n,a,i,l,c){var d=a.candidate,m=a.type,p=d.id,_=m==="thread"?2:1,f=await t.tables.threads.get((e||(e=o("I64"))).of_string(p)),g=d.isInstamadilloCutover||d.isDisappearingModeSettingOn;if(o("LSBitFlag").has((s||(s=o("LSIntEnum"))).ofNumber(1),n.displayedContentTypes)){var h=o("IGDThreadTTLCUtils").isInstamadilloTTLCTextEnabled(f),y=g||h;return o("sendToSentQPLLogger").addSendToSentAnnotations(c,{bool:{use_instamadillo_transport:y,use_open_eb:h}}),r("forwardText")(n.text,d.id,_,i,l,{useInstamadilloTransport:y,useOpenEb:h})}var C=o("ReQL").fromTableDescending(t.tables.attachments).getKeyRange(n.threadKey,n.messageId),b=await o("ReQL").toArrayAsync(C);if(b.length>1&&u)return r("forwardAttachmentCollectionToOpen")(n,p,_,i,l);if(b.length>0){var v=b[0],S=(s||(s=o("LSIntEnum"))).unwrapIntEnum(v.attachmentType);if(S===r("MessagingAttachmentType").XMA)if(v.stickerType==="cutout_sticker"||v.stickerType==="music_sticker"){var R,L,E,k=await t.tables.ig_thread_info.get((e||(e=o("I64"))).of_string(p)),I=k==null?void 0:k.igThreadId,T=n.threadKey,D=await t.tables.ig_thread_info.get(T),x=D==null?void 0:D.igThreadId;if(I==null||x==null)throw r("FBLogger")("igd_web").mustfixThrow("Failed to forward the cutout sticker");var $=o("MercuryLocalIDs").generateOfflineThreadingID(),P=e.of_float(Date.now()),N=1032,M=v.stickerType==="music_sticker"?"music_sticker":"cutout_sticker",w=v.stickerType==="music_sticker"?v.titleText:"",A=v.stickerType==="music_sticker"?v.subtitleText:"";return await r("sendIGDOptimisticRichContentMessage")(t,(R=v.previewHeight)!=null?R:(e||(e=o("I64"))).zero,(L=v.previewWidth)!=null?L:(e||(e=o("I64"))).zero,$,e.of_int32(N),i,P,e.of_string(p),r("MessagingAttachmentType").XMA,(E=v.previewUrl)!=null?E:"",M,null,!1,w,A,null),o("PolarisDirectAPI").broadcastForward(I,o("PolarisDirectConstants").ThreadItemType.GENERIC_XMA,n.messageId,x,$)}else return r("forwardXMA")(n,v,d.id,_,i,l,d,c);else{if(S===r("MessagingAttachmentType").ANIMATED_IMAGE)return r("forwardAttachmentToOpen")(v.attachmentFbid,d.id,_,i,l);var F=!1;S===r("MessagingAttachmentType").IMAGE?F=o("IGDThreadTTLCUtils").isInstamadilloTTLCImageEnabled(f):S===r("MessagingAttachmentType").VIDEO?F=o("IGDThreadTTLCUtils").isInstamadilloTTLCVideoEnabled(f):S===r("MessagingAttachmentType").AUDIO&&(F=o("IGDThreadTTLCUtils").isInstamadilloTTLCAudioEnabled(f));var O=g||F;return o("sendToSentQPLLogger").addSendToSentAnnotations(c,{bool:{use_instamadillo_transport:O,use_open_eb:F}}),r("forwardAttachment")(v,d.id,_,i,l,{useInstamadilloTransport:O,useOpenEb:F})}}}function d(e){var t=o("react-compiler-runtime").c(5),n=r("useAsyncReStore")(),a=r("useGetForwardSource")(),i=o("MWPActor.react").useActor(),l;return t[0]!==n||t[1]!==e||t[2]!==i||t[3]!==a?(l=async function(l){var t=o("sendToSentQPLLogger").markSendToSentStart(),s=await m(await n,e);o("sendToSentQPLLogger").addSendToSentAnnotations(t,s);try{await c(await n,e,l,i,a,t),o("sendToSentQPLLogger").markSendToSentSuccess(t)}catch(e){var u=e,d=r("getErrorSafe")(u);o("sendToSentQPLLogger").markSendToSentFail(t,"message_send_fail",d),r("FBLogger")("igd_web").catching(d).mustfix("IGD failure forwarding a message")}},t[0]=n,t[1]=e,t[2]=i,t[3]=a,t[4]=l):l=t[4],l}async function m(t,n){var a=await o("ReQL").firstAsync(o("ReQL").fromTableDescending(t.tables.attachments).getKeyRange(n.threadKey,n.messageId)),i=a!=null?Object.keys(r("MessagingAttachmentType")).find(function(e){return r("MessagingAttachmentType")[e]===(s||(s=o("LSIntEnum"))).unwrapIntEnum(a.attachmentType)}):null,l=(e||(e=o("I64"))).equal(n.displayedContentTypes,(s||(s=o("LSIntEnum"))).ofNumber(1))?"text":"non-text";return{bool:{is_forward_message:!0},string:{attachment_type:i,message_type:l}}}l.default=d}),98);
__d("useIGDMessageMsysForward",["fbt","I64","IGDContactSearchDialogType.flow","IGDInstamadilloUtils","IGDSDialogPlaceholder.react","IGDThreadListNewMessageLoggingDataContext","JSResourceForInteraction","LSBitFlag","LSContactBitOffset","LSContactBlockedByViewerStatus","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MNLSXMALayoutType","MWLSThread","MWPActor.react","MWV2MessageRowIsRowFocusedContext.react","MessagingAttachmentType","MessengerWebUXLogger","ReQL","ReQLSuspense","qex","react","react-compiler-runtime","useIGDForwardMessage","useIGDMessageAttachment","useIGDSLazyDialog","useIsReadOnlyFeatureLimited","useIsThreadBlocked","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d,m=d||(d=o("react")),p=function(){return r("qex")._("121")===!0},_=r("qex")._("41")===!0;function f(t,n,a){var l=o("react-compiler-runtime").c(17),d=(e||(e=r("useReStore")))(),m=o("MWPActor.react").useActor(),f=t.displayedContentTypes,C=t.senderId,b=t.threadKey,v=r("useIsReadOnlyFeatureLimited")(),S=r("useIsThreadBlocked")(),R=o("MWLSThread").useThreadExn(t.threadKey),L=R.threadType,E;l[0]!==d.tables.contacts||l[1]!==C?(E=function(){return o("ReQL").fromTableAscending(d.tables.contacts).getKeyRange(C)},l[0]=d.tables.contacts,l[1]=C,l[2]=E):E=l[2];var k;l[3]!==d||l[4]!==C?(k=[d,C],l[3]=d,l[4]=C,l[5]=k):k=l[5];var I=o("ReQLSuspense").useFirst(E,k,i.id+":70"),T=I!=null&&o("LSContactBitOffset").has(66,I),D=o("LSThreadBitOffset").has(103,R),x=o("LSMessagingThreadTypeUtil").isIGDMessageRequest(R),$=(u||(u=o("I64"))).equal(t.displayedContentTypes,(c||(c=o("LSIntEnum"))).ofNumber(256)),P=u.equal(C,m),N=!P&&o("LSMessagingThreadTypeUtil").isOneToOne(L)&&I!=null?!(u||(u=o("I64"))).equal(I.blockedByViewerStatus,(c||(c=o("LSIntEnum"))).ofNumber(r("LSContactBlockedByViewerStatus").UNBLOCKED)):!1,M=r("useIGDMessageAttachment")(d,t,b),w=M.attachment,A=M.hasMultipleAttachments,F=M.isVideoStack,O=w!=null&&((u||(u=o("I64"))).equal(w.attachmentType,(c||(c=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").EPHEMERAL_IMAGE))||(u||(u=o("I64"))).equal(w.attachmentType,(c||(c=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").EPHEMERAL_VIDEO))),B=w!=null&&(u||(u=o("I64"))).equal(w.attachmentType,(c||(c=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO)),W=w!=null&&(u||(u=o("I64"))).equal(w.attachmentType,(c||(c=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").STICKER)),q=w!=null&&(u||(u=o("I64"))).equal(w.attachmentType,(c||(c=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))?w.xmaLayoutType!=null&&!((u||(u=o("I64"))).equal(w.xmaLayoutType,(c||(c=o("LSIntEnum"))).ofNumber(r("MNLSXMALayoutType").PLACEHOLDER))||(u||(u=o("I64"))).equal(w.xmaLayoutType,(c||(c=o("LSIntEnum"))).ofNumber(r("MNLSXMALayoutType").EXPIRED_PLACEHOLDER))):!0,U=w!=null&&(u||(u=o("I64"))).equal(w.attachmentType,(c||(c=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))&&w.stickerType==="ai_generated_sticker",V=(u||(u=o("I64"))).equal(f,o("LSBitFlag").empty)&&!O,H=r("useIGDForwardMessage")(t),G=r("MessengerWebUXLogger").useInteractionLogger(),z=o("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),j=o("MWV2MessageRowIsRowFocusedContext.react").useMWV2MessageRowIsRowFocusedContext(),K=j.setIsDialogOpened,Q;l[6]===Symbol.for("react.memo_cache_sentinel")?(Q=r("JSResourceForInteraction")("IGDAWOminipickerDialog.react").__setRef("useIGDMessageMsysForward"),l[6]=Q):Q=l[6];var X=r("useIGDSLazyDialog")(Q,y),Y=X[0],J=o("IGDInstamadilloUtils").isInstamadilloMessage(t)&&t.ephemeralDurationInSec!=null&&(u||(u=o("I64"))).gt(t.ephemeralDurationInSec,(u||(u=o("I64"))).zero),Z=!a&&!S&&!T&&!x&&!v&&!t.isUnsent&&!V&&(o("LSMessagingThreadTypeUtil").isArmadilloSecure(L)?p():!0)&&D&&q&&!N&&!$&&!O&&!B&&!J&&(!A||_)&&!F&&!W&&!U;if(!Z)return null;var ee;l[7]!==H?(ee=async function(t){Array.from(t.values()).map(function(e){return H(e)})},l[7]=H,l[8]=ee):ee=l[8];var te=ee,ne;l[9]!==z||l[10]!==A||l[11]!==G||l[12]!==n||l[13]!==te||l[14]!==K||l[15]!==Y?(ne=function(){G==null||G({eventName:"message_forward",extraData:{},flowInstanceId:z}),A&&_&&(G==null||G({eventName:"media_collection_message_forward"})),Y({includeGroup:!0,loggingEventName:"forward_thread_attempt",maxRecipients:5,onSubmit:te,searchType:o("IGDContactSearchDialogType.flow").IGDContactSearchDialogType.FORWARD_MESSAGE,submitButtonLabel:s._(/*BTDS*/"Enviar").toString(),titleLabel:s._(/*BTDS*/"Encaminhar").toString()},function(){n(),K(h)}),K(g)},l[9]=z,l[10]=A,l[11]=G,l[12]=n,l[13]=te,l[14]=K,l[15]=Y,l[16]=ne):ne=l[16];var re=ne;return re}function g(){return!0}function h(){return!1}function y(e){return m.jsx(r("IGDSDialogPlaceholder.react"),{fixedHeight:!0,onClose:e,size:"large"})}y.displayName=y.name+" [from "+i.id+"]",l.default=f}),226);
__d("useIGDMessageForwardMenuItem.react",["fbt","IGDMessageContextMenuItem.react","IGDSMessagesOutlineIcon.react","react","react-compiler-runtime","useIGDMessageMsysForward"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(e,t,n){var a=o("react-compiler-runtime").c(4),i=r("useIGDMessageMsysForward")(e,t,n);if(i==null)return null;var l;a[0]===Symbol.for("react.memo_cache_sentinel")?(l=s._(/*BTDS*/"Encaminhar"),a[0]=l):l=a[0];var c=l,d;a[1]===Symbol.for("react.memo_cache_sentinel")?(d=u.jsx(r("IGDSMessagesOutlineIcon.react"),{alt:c,size:18}),a[1]=d):d=a[1];var m;return a[2]!==i?(m=u.jsx(r("IGDMessageContextMenuItem.react"),{icon:d,label:c,onClick:i,testid:void 0}),a[2]=i,a[3]=m):m=a[3],m}l.default=c}),226);
__d("useIGDMessageInspectMenuItem.react",["fbt","IGDMessageContextMenuItem.react","IGDSDialogPlaceholder.react","IGDSSearchPanoOutlineIcon.react","JSResourceForInteraction","MWV2MessageRowIsRowFocusedContext.react","gkx","react","react-compiler-runtime","useIGDSLazyDialog"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useCallback,d={dialog:{height:"xrqonrr",width:"x1m7g9aj",$$css:!0}};function m(e){var t=o("react-compiler-runtime").c(9),n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=s._(/*BTDS*/"[Internal] Inspect"),t[0]=n):n=t[0];var a=n,i=o("MWV2MessageRowIsRowFocusedContext.react").useMWV2MessageRowIsRowFocusedContext(),l=i.setIsDialogOpened,c;t[1]===Symbol.for("react.memo_cache_sentinel")?(c=r("JSResourceForInteraction")("IGDMessageInspectMessageDialog.react").__setRef("useIGDMessageInspectMenuItem.react"),t[1]=c):c=t[1];var d=r("useIGDSLazyDialog")(c,f),m=d[0],g;t[2]!==e||t[3]!==l||t[4]!==m?(g=function(){m({message:e},function(){l(_)}),l(p)},t[2]=e,t[3]=l,t[4]=m,t[5]=g):g=t[5];var h=g,y=r("gkx")("24015");if(!y)return null;var C;t[6]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("IGDSSearchPanoOutlineIcon.react"),{alt:a,size:18}),t[6]=C):C=t[6];var b;return t[7]!==h?(b=u.jsx(r("IGDMessageContextMenuItem.react"),{delimiter:!0,icon:C,label:a,onClick:h,testid:void 0}),t[7]=h,t[8]=b):b=t[8],b}function p(){return!0}function _(){return!1}function f(e){return u.jsx(r("IGDSDialogPlaceholder.react"),{innerContentXStyle:d.dialog,onClose:e})}f.displayName=f.name+" [from "+i.id+"]",l.default=m}),226);
__d("useIGDMessageNegativeFeedbackMenuItem.react",["fbt","IGDMessageContextMenuItem.react","IGDSDialogPlaceholder.react","IGDSThumbDownPanoOutline24Icon.react","JSResourceForInteraction","emptyFunction","react","react-compiler-runtime","useGenAIFeedbackSubmissionStatus","useIGDIsGenAiReelsPlugin","useIGDSLazyDialog","useIGDSToaster","useMWV2SubmitFeedbackAction"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useCallback;function d(e,t){var n=o("react-compiler-runtime").c(11),a=r("useIGDSToaster")(),i;n[0]!==a?(i=function(){a.add({message:s._(/*BTDS*/"Feedback enviado"),target:"bottom-left"})},n[0]=a,n[1]=i):i=n[1];var l=i,c=r("useMWV2SubmitFeedbackAction")(e.botResponseId,l),d;n[2]===Symbol.for("react.memo_cache_sentinel")?(d=r("JSResourceForInteraction")("MWV2SubmitNegativeFeedbackDialog.react").__setRef("useIGDMessageNegativeFeedbackMenuItem.react"),n[2]=d):d=n[2];var p=r("useIGDSLazyDialog")(d,m),_=p[0],f;n[3]!==e||n[4]!==c||n[5]!==_?(f=function(){_({message:e,onSubmit:c},r("emptyFunction"))},n[3]=e,n[4]=c,n[5]=_,n[6]=f):f=n[6];var g=f,h=r("useGenAIFeedbackSubmissionStatus")(e.botResponseId),y=r("useIGDIsGenAiReelsPlugin")(e);if(h==null||y||t)return null;var C;n[7]===Symbol.for("react.memo_cache_sentinel")?(C=s._(/*BTDS*/"Resposta ruim"),n[7]=C):C=n[7];var b=C,v;n[8]===Symbol.for("react.memo_cache_sentinel")?(v=u.jsx(r("IGDSThumbDownPanoOutline24Icon.react"),{alt:b,size:18}),n[8]=v):v=n[8];var S;return n[9]!==g?(S=u.jsx(r("IGDMessageContextMenuItem.react"),{icon:v,label:b,onClick:g}),n[9]=g,n[10]=S):S=n[10],S}function m(e){return u.jsx(r("IGDSDialogPlaceholder.react"),{fixedHeight:!0,onClose:e,size:"large"})}m.displayName=m.name+" [from "+i.id+"]",l.default=d}),226);
__d("useIGDMessagePositiveFeedbackMenuItem.react",["fbt","BotFeedbackKind","IGDMessageContextMenuItem.react","IGDSThumbUpPanoOutline24Icon.react","IGDThreadListNewMessageLoggingDataContext","MessengerWebUXLogger","react","react-compiler-runtime","useGenAIFeedbackSubmissionStatus","useIGDIsGenAiReelsPlugin","useIGDSToaster","useMWV2SubmitFeedbackAction"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useMemo;function p(e,t,n){var a,i=o("react-compiler-runtime").c(16),l=r("useIGDSToaster")(),c;i[0]!==l?(c=function(){l.add({message:s._(/*BTDS*/"Feedback enviado"),target:"bottom-left"})},i[0]=l,i[1]=c):c=i[1];var d=c,m=r("useMWV2SubmitFeedbackAction")(e.botResponseId,d),p=o("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),_=(a=e.botResponseId)!=null?a:"",f;i[2]!==_?(f={botResponseId:_},i[2]=_,i[3]=f):f=i[3];var g;i[4]!==p||i[5]!==f?(g={extraData:f,flowInstanceId:p},i[4]=p,i[5]=f,i[6]=g):g=i[6];var h=g,y=r("MessengerWebUXLogger").useInteractionLogger(),C;i[7]!==h||i[8]!==y||i[9]!==t||i[10]!==m?(C=function(){m(r("BotFeedbackKind").BOT_FEEDBACK_POSITIVE),y==null||y(babelHelpers.extends({eventName:"submit_positive_feedback"},h)),t()},i[7]=h,i[8]=y,i[9]=t,i[10]=m,i[11]=C):C=i[11];var b=C,v=r("useGenAIFeedbackSubmissionStatus")(e.botResponseId),S=r("useIGDIsGenAiReelsPlugin")(e);if(v==null||S||n)return null;var R;i[12]===Symbol.for("react.memo_cache_sentinel")?(R=s._(/*BTDS*/"Resposta boa"),i[12]=R):R=i[12];var L=R,E;i[13]===Symbol.for("react.memo_cache_sentinel")?(E=u.jsx(r("IGDSThumbUpPanoOutline24Icon.react"),{alt:L,size:18}),i[13]=E):E=i[13];var k;return i[14]!==b?(k=u.jsx(r("IGDMessageContextMenuItem.react"),{delimiter:!0,icon:E,label:L,onClick:b}),i[14]=b,i[15]=k):k=i[15],k}l.default=p}),226);
__d("useIGDMessageReaction.react",["fbt","EmojiFormat.bs","IGDThreadListNewMessageLoggingDataContext","Int64Hooks","MWLSThread","MWV2MessageReactionHooks","MessengerWebUXLogger","UnicodeUtils","emptyFunction","promiseDone","react","react-compiler-runtime","useAsyncReStore","useIGDGlobalReactMessage"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=(e||(e=o("react"))).useCallback;function d(e,t){var n,a=o("react-compiler-runtime").c(20),i=(n=o("MWV2MessageReactionHooks").MWV2MessageReactionHooks.useSelectedReaction(e.messageId,e.threadKey))==null?void 0:n.reaction,l=r("useIGDGlobalReactMessage")(e,"reaction_tray"),c;a[0]!==t||a[1]!==i||a[2]!==l?(c=function(n){var e=o("EmojiFormat.bs").codeArrayToUnicode(n);if(i!=null){var a=(u||(u=o("UnicodeUtils"))).getCodePoints(i);e===i&&(e=void 0),a[0]===10084&&n[0]===10084&&(e=void 0)}r("promiseDone")(l(e,"reaction")),t()},a[0]=t,a[1]=i,a[2]=l,a[3]=c):c=a[3];var d=c,m;a[4]!==d?(m={closeAfterSelect:!0,onClose:r("emptyFunction"),onSelect:d,showPopoverArrow:!1},a[4]=d,a[5]=m):m=a[5];var p=m,_;a[6]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Reagir"),a[6]=_):_=a[6];var f=_,g=r("useAsyncReStore")(),h=r("MessengerWebUXLogger").useInteractionLogger(),y=o("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),C,b;a[7]!==g||a[8]!==y||a[9]!==h||a[10]!==e.messageId||a[11]!==e.threadKey?(C=function(n){r("promiseDone")(g.then(async function(t){var n=await o("MWLSThread").getThreadAsync(t,e.threadKey);n&&(h==null||h({eventName:"reaction_open_emoji_picker",extraData:{message_id:e.messageId},flowInstanceId:y}))})),n()},b=[g,y,h,e.messageId,e.threadKey],a[7]=g,a[8]=y,a[9]=h,a[10]=e.messageId,a[11]=e.threadKey,a[12]=C,a[13]=b):(C=a[12],b=a[13]);var v=o("Int64Hooks").useCallbackInt64(C,b),S;a[14]!==i?(S=i!=null?(u||(u=o("UnicodeUtils"))).getCodePoints(i):null,a[14]=i,a[15]=S):S=a[15];var R;return a[16]!==v||a[17]!==p||a[18]!==S?(R=[f,v,p,S],a[16]=v,a[17]=p,a[18]=S,a[19]=R):R=a[19],R}l.default=d}),226);
__d("useIGDMessageReactionMenuItem.react",["I64","IGDMessageReactionTrayButtonLazyLoadPopoverTrigger.react","LSBitFlag","LSContactBitOffset","LSMessagingThreadTypeUtil","LSThreadBitOffset","MWLSThread","ReQL","ReQLSuspense","gkx","react","react-compiler-runtime","useGenAIFeedbackSubmissionStatus","useIGDMessageReaction.react","useIsGenAiFeedbackEnabled","useIsReadOnlyFeatureLimited","useIsThreadBlocked","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react"));function d(t,n,a){var l=o("react-compiler-runtime").c(14),u=(e||(e=r("useReStore")))(),d=t.displayedContentTypes,m=t.senderId,p=r("useIsThreadBlocked")(),_=o("MWLSThread").useThreadExn(t.threadKey),f=o("LSMessagingThreadTypeUtil").isIGDMessageRequest(_),g=r("useIsReadOnlyFeatureLimited")(),h;l[0]!==u.tables.contacts||l[1]!==m?(h=function(){return o("ReQL").fromTableAscending(u.tables.contacts).getKeyRange(m)},l[0]=u.tables.contacts,l[1]=m,l[2]=h):h=l[2];var y;l[3]!==u||l[4]!==m?(y=[u,m],l[3]=u,l[4]=m,l[5]=y):y=l[5];var C=o("ReQLSuspense").useFirst(h,y,i.id+":50"),b=o("LSThreadBitOffset").has(18,_),v=o("LSThreadBitOffset").has(139,_),S=o("LSThreadBitOffset").has(169,_),R=(s||(s=o("I64"))).equal(d,o("LSBitFlag").empty),L=C!=null&&o("LSContactBitOffset").has(66,C),E=r("useIsGenAiFeedbackEnabled")(t.botResponseId,r("gkx")("4253")===!0),k=r("useGenAIFeedbackSubmissionStatus")(t.botResponseId),I=!a&&!p&&!L&&!f&&!g&&!t.isUnsent&&!R&&(v?S:b)&&E&&k==null,T=r("useIGDMessageReaction.react")(t,n),D=T[0],x=T[1],$=T[2],P=T[3];if(!I)return null;var N;l[6]!==x?(N=function(t){return x(t)},l[6]=x,l[7]=N):N=l[7];var M;return l[8]!==D||l[9]!==$.onClose||l[10]!==$.onSelect||l[11]!==P||l[12]!==N?(M=c.jsx(r("IGDMessageReactionTrayButtonLazyLoadPopoverTrigger.react"),{align:"start",altLabel:D,label:D,onClickAction:N,onClose:$.onClose,onSelect:$.onSelect,selectedReaction:P,useMenuItem:!0}),l[8]=D,l[9]=$.onClose,l[10]=$.onSelect,l[11]=P,l[12]=N,l[13]=M):M=l[13],M}l.default=d}),98);
__d("useIGDMessageReplyMenuItem.react",["I64","IGDInstamadilloUtils","IGDMessageContextMenuItem.react","IGDSReplyPanoOutline24Icon.react","LSBitFlag","LSContactBitOffset","LSMessagingThreadTypeUtil","LSThreadBitOffset","MWLSThread","ReQL","ReQLSuspense","gkx","react","react-compiler-runtime","useGenAIFeedbackSubmissionStatus","useIGDMessageReply.react","useIsGenAiFeedbackEnabled","useIsReadOnlyFeatureLimited","useIsThreadBlocked","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react"));function d(t,n,a){var l=o("react-compiler-runtime").c(12),u=(e||(e=r("useReStore")))(),d=t.displayedContentTypes,m=t.senderId,p=r("useIsThreadBlocked")(),_=o("MWLSThread").useThreadExn(t.threadKey),f=o("LSMessagingThreadTypeUtil").isIGDMessageRequest(_),g=r("useIsReadOnlyFeatureLimited")(),h;l[0]!==u.tables.contacts||l[1]!==m?(h=function(){return o("ReQL").fromTableAscending(u.tables.contacts).getKeyRange(m)},l[0]=u.tables.contacts,l[1]=m,l[2]=h):h=l[2];var y;l[3]!==u||l[4]!==m?(y=[u,m],l[3]=u,l[4]=m,l[5]=y):y=l[5];var C=o("ReQLSuspense").useFirst(h,y,i.id+":53"),b=o("LSThreadBitOffset").has(42,_),v=r("useIGDMessageReply.react")(t,_,n),S=v[0],R=v[1],L=r("useIsGenAiFeedbackEnabled")(t.botResponseId,r("gkx")("4253")===!0),E=r("useGenAIFeedbackSubmissionStatus")(t.botResponseId);if(!b||!L)return null;var k=(s||(s=o("I64"))).equal(d,o("LSBitFlag").empty),I=C!=null&&o("LSContactBitOffset").has(66,C),T=o("IGDInstamadilloUtils").isIGDDisappearingModeEnabled(_),D=!a&&!p&&!I&&!f&&!g&&!t.isUnsent&&!k&&L&&E==null&&o("IGDInstamadilloUtils").shouldRenderMessageReply(t,T);if(!D)return null;var x;l[6]!==R?(x=c.jsx(r("IGDSReplyPanoOutline24Icon.react"),{alt:R,size:18}),l[6]=R,l[7]=x):x=l[7];var $;return l[8]!==R||l[9]!==S||l[10]!==x?($=c.jsx(r("IGDMessageContextMenuItem.react"),{icon:x,label:R,onClick:S}),l[8]=R,l[9]=S,l[10]=x,l[11]=$):$=l[11],$}l.default=d}),98);
__d("IGDMessageReportMenuItem.react",["fbt","IGDMessageContextMenuItem.react","IGDSReportPanoOutline24Icon.react","MWPActor.react","emptyFunction","promiseDone","react","react-compiler-runtime","requireDeferred","useIGDSLazyDialog","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d=u.useCallback,m=r("requireDeferred")("MWLogMessageAction").__setRef("IGDMessageReportMenuItem.react");function p(t){var n=o("react-compiler-runtime").c(13),a=t.dialogProps,i=t.dialogResource,l=t.message,u=o("MWPActor.react").useActor(),d=(e||(e=r("useReStore")))(),p;n[0]===Symbol.for("react.memo_cache_sentinel")?(p=s._(/*BTDS*/"Denunciar"),n[0]=p):p=n[0];var _=p,f=r("useIGDSLazyDialog")(i),g=f[0],h;n[1]!==u||n[2]!==d||n[3]!==a||n[4]!==l.messageId||n[5]!==l.senderId||n[6]!==l.threadKey||n[7]!==g?(h=function(){g(a,r("emptyFunction")),m.onReady(function(e){return r("promiseDone")(e.log(d,l.messageId,l.threadKey,"message_dot_menu","report",void 0,void 0,void 0,l.senderId,void 0,u))})},n[1]=u,n[2]=d,n[3]=a,n[4]=l.messageId,n[5]=l.senderId,n[6]=l.threadKey,n[7]=g,n[8]=h):h=n[8];var y=h,C;n[9]===Symbol.for("react.memo_cache_sentinel")?(C=c.jsx(r("IGDSReportPanoOutline24Icon.react"),{alt:_,color:"ig-error-or-destructive",size:18}),n[9]=C):C=n[9];var b;n[10]===Symbol.for("react.memo_cache_sentinel")?(b={color:"errorOrDestructive"},n[10]=b):b=n[10];var v;return n[11]!==y?(v=c.jsx(r("IGDMessageContextMenuItem.react"),{delimiter:!0,icon:C,label:_,labelProps:b,onClick:y,testid:void 0}),n[11]=y,n[12]=v):v=n[12],v}l.default=p}),226);
__d("useIGDMessageReportMenuItem.react",["I64","IGDMessageReportMenuItem.react","JSResourceForInteraction","LSContactBitOffset","LSIntEnum","LSMessagingThreadTypeUtil","MWPActor.react","ReQL","ReQLSuspense","emptyFunction","getLSMediaContactProfilePictureUrl","react","react-compiler-runtime","useMWBShouldReportThreadAsInstamadillo","usePolarisAnalyticsContext","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=s||(s=o("react")),m=[(u||(u=o("LSIntEnum"))).ofNumber(1),u.ofNumber(16384),u.ofNumber(2),u.ofNumber(4),(c||(c=o("I64"))).add(u.ofNumber(1),u.ofNumber(8192)),c.add(u.ofNumber(16384),u.ofNumber(8192)),c.add(u.ofNumber(2),u.ofNumber(8192)),c.add(u.ofNumber(4),u.ofNumber(8192))];function p(t,n){var a,l=o("react-compiler-runtime").c(61),s=(e||(e=r("useReStore")))(),u=o("MWPActor.react").useActor(),p=t.displayedContentTypes,_=t.senderId,f;l[0]!==s.tables.contacts||l[1]!==_?(f=function(){return o("ReQL").fromTableAscending(s.tables.contacts).getKeyRange(_)},l[0]=s.tables.contacts,l[1]=_,l[2]=f):f=l[2];var g;l[3]!==s||l[4]!==_?(g=[s,_],l[3]=s,l[4]=_,l[5]=g):g=l[5];var h=o("ReQLSuspense").useFirst(f,g,i.id+":65"),y=h!=null&&o("LSContactBitOffset").has(18,h),C=(c||(c=o("I64"))).equal(_,u),b;l[6]!==s.tables.contacts||l[7]!==t.senderId?(b=function(){return o("ReQL").fromTableAscending(s.tables.contacts).getKeyRange(t.senderId)},l[6]=s.tables.contacts,l[7]=t.senderId,l[8]=b):b=l[8];var v;l[9]!==s||l[10]!==t.senderId?(v=[s,t.senderId],l[9]=s,l[10]=t.senderId,l[11]=v):v=l[11];var S=o("ReQLSuspense").useFirst(b,v,i.id+":77"),R;l[12]!==s.tables.ig_thread_info||l[13]!==t.threadKey?(R=function(){return o("ReQL").fromTableAscending(s.tables.ig_thread_info).getKeyRange(t.threadKey)},l[12]=s.tables.ig_thread_info,l[13]=t.threadKey,l[14]=R):R=l[14];var L;l[15]!==s||l[16]!==t.threadKey?(L=[s,t.threadKey],l[15]=s,l[16]=t.threadKey,l[17]=L):L=l[17];var E=o("ReQLSuspense").useFirst(R,L,i.id+":82"),k;l[18]!==s.tables.threads||l[19]!==t.threadKey?(k=function(){return o("ReQL").fromTableAscending(s.tables.threads).getKeyRange(t.threadKey)},l[18]=s.tables.threads,l[19]=t.threadKey,l[20]=k):k=l[20];var I;l[21]!==s||l[22]!==t.threadKey?(I=[s,t.threadKey],l[21]=s,l[22]=t.threadKey,l[23]=I):I=l[23];var T=o("ReQLSuspense").useFirst(k,I,i.id+":90"),D;l[24]!==u||l[25]!==s.tables.mailbox_metadata?(D=function(){return o("ReQL").fromTableAscending(s.tables.mailbox_metadata).getKeyRange(u)},l[24]=u,l[25]=s.tables.mailbox_metadata,l[26]=D):D=l[26];var x;l[27]!==u||l[28]!==s?(x=[s,u],l[27]=u,l[28]=s,l[29]=x):x=l[29];var $=o("ReQLSuspense").useFirst(D,x,i.id+":95"),P=r("useMWBShouldReportThreadAsInstamadillo")(T),N=r("usePolarisAnalyticsContext")()+"WWW",M=y&&!C&&m.findIndex(function(e){return(c||(c=o("I64"))).equal(p,e)})!==-1;if(!M||S==null||$==null||E==null||T==null)return null;var w;l[30]!==n?(w=o("LSMessagingThreadTypeUtil").isGroup(n),l[30]=n,l[31]=w):w=l[31];var A;l[32]!==S?(A=r("getLSMediaContactProfilePictureUrl")(S),l[32]=S,l[33]=A):A=l[33];var F;l[34]!==t.senderId?(F=(c||(c=o("I64"))).to_string(t.senderId),l[34]=t.senderId,l[35]=F):F=l[35];var O=(a=S.secondaryName)!=null?a:"",B;l[36]!==P||l[37]!==w||l[38]!==A||l[39]!==F||l[40]!==O?(B={isGroup:w,onClose:r("emptyFunction"),profilePicUrl:A,senderId:F,shouldReportAsInstamadillo:P,username:O},l[36]=P,l[37]=w,l[38]=A,l[39]=F,l[40]=O,l[41]=B):B=l[41];var W=B,q;if(P){var U=t.messageId,V;l[42]!==t.threadKey?(V=(c||(c=o("I64"))).to_string(t.threadKey),l[42]=t.threadKey,l[43]=V):V=l[43];var H;l[44]!==t.messageId||l[45]!==W||l[46]!==V?(H=babelHelpers.extends({},W,{reportedObjectID:U,threadId:V}),l[44]=t.messageId,l[45]=W,l[46]=V,l[47]=H):H=l[47],q=H}else{var G=E.igThreadId,z;l[48]!==t.messageId?(z=btoa(t.messageId),l[48]=t.messageId,l[49]=z):z=l[49];var j=encodeURI(z),K;l[50]!==$.id?(K=(c||(c=o("I64"))).to_string($.id),l[50]=$.id,l[51]=K):K=l[51];var Q=G+"_"+j+"_"+K,X;l[52]!==N||l[53]!==W||l[54]!==Q||l[55]!==E.igThreadId?(X=babelHelpers.extends({},W,{containerModule:N,reportedObjectID:Q,threadId:E.igThreadId}),l[52]=N,l[53]=W,l[54]=Q,l[55]=E.igThreadId,l[56]=X):X=l[56],q=X}var Y=q,J;l[57]===Symbol.for("react.memo_cache_sentinel")?(J=r("JSResourceForInteraction")("PolarisDirectReportingMessageModal.react").__setRef("useIGDMessageReportMenuItem.react"),l[57]=J):J=l[57];var Z;return l[58]!==t||l[59]!==q?(Z=d.jsx(r("IGDMessageReportMenuItem.react"),{dialogProps:Y,dialogResource:J,message:t}),l[58]=t,l[59]=q,l[60]=Z):Z=l[60],Z}l.default=p}),98);
__d("useIGDMessageUnsendMenuItem.react",["fbt","I64","IGDMessageContextMenuItem.react","IGDSUndoCirclePanoOutline24Icon.react","IGDThreadListNewMessageLoggingDataContext","Int64Hooks","JSResourceForInteraction","MWPActor.react","MWPThreadCapabilitiesContext","MWV2MessageRowIsRowFocusedContext.react","MessengerWebUXLogger","PolarisDirectLogger","react","react-compiler-runtime","useIGDIsCannesThread.react","useIGDSLazyDialog"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react"));function d(e,t){var n=o("react-compiler-runtime").c(19),a=o("MWPActor.react").useActor(),i=e.senderId,l=(u||(u=o("I64"))).equal(i,a),d=r("MessengerWebUXLogger").useInteractionLogger(),_=o("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),f=o("MWV2MessageRowIsRowFocusedContext.react").useMWV2MessageRowIsRowFocusedContext(),g=f.setIsDialogOpened,h;n[0]===Symbol.for("react.memo_cache_sentinel")?(h=r("JSResourceForInteraction")("IGDMessageUnsendDialog.react").__setRef("useIGDMessageUnsendMenuItem.react"),n[0]=h):h=n[0];var y=r("useIGDSLazyDialog")(h),C=y[0],b;n[1]!==_||n[2]!==d||n[3]!==e||n[4]!==g||n[5]!==C?(b=function(){d==null||d({eventName:"message_unsend",extraData:{},flowInstanceId:_}),C({message:e},function(){g(p)}),g(m),o("PolarisDirectLogger").DirectLogger.logDirectEvent("DirectThread","direct_delete_message_attempt")},n[1]=_,n[2]=d,n[3]=e,n[4]=g,n[5]=C,n[6]=b):b=n[6];var v;n[7]!==_||n[8]!==d||n[9]!==e||n[10]!==g||n[11]!==C||n[12]!==t?(v=[_,d,e,g,C,t],n[7]=_,n[8]=d,n[9]=e,n[10]=g,n[11]=C,n[12]=t,n[13]=v):v=n[13];var S=o("Int64Hooks").useCallbackInt64(b,v),R=o("MWPThreadCapabilitiesContext").useMWPThreadCapabilitiesContext(),L=R.messageUnsendEnabled,E=r("useIGDIsCannesThread.react")(t.threadKey,t.threadType);if(!L||!l||E)return null;var k;n[14]===Symbol.for("react.memo_cache_sentinel")?(k=s._(/*BTDS*/"Cancelar envio"),n[14]=k):k=n[14];var I=k,T;n[15]===Symbol.for("react.memo_cache_sentinel")?(T=c.jsx(r("IGDSUndoCirclePanoOutline24Icon.react"),{alt:I,color:"ig-error-or-destructive",size:18}),n[15]=T):T=n[15];var D;n[16]===Symbol.for("react.memo_cache_sentinel")?(D={color:"errorOrDestructive"},n[16]=D):D=n[16];var x;return n[17]!==S?(x=c.jsx(r("IGDMessageContextMenuItem.react"),{delimiter:!0,icon:T,label:I,labelProps:D,onClick:S}),n[17]=S,n[18]=x):x=n[18],x}function m(){return!0}function p(){return!1}l.default=d}),226);
__d("IGDMessageContextMenu.react",["I64","IGDBroadcastChannelLoggingShapes","IGDSBox.react","IGDSPopover.react","IGDThreadListNewMessageLoggingDataContext","MWCMThreadTypes.react","MessengerWebUXLogger","WebUXLoggingSurfaceContextProvider","cr:21429","isMWEditedMessage","react","react-compiler-runtime","useIGDBroadcastChannelImpressionLoggerWithCheck","useIGDEditMessageMenuItem.react","useIGDMessageCopyMenuItem.react","useIGDMessageForwardMenuItem.react","useIGDMessageInspectMenuItem.react","useIGDMessageNegativeFeedbackMenuItem.react","useIGDMessagePositiveFeedbackMenuItem.react","useIGDMessageReactionMenuItem.react","useIGDMessageReplyMenuItem.react","useIGDMessageReportMenuItem.react","useIGDMessageTimestampMenuItem.react","useIGDMessageUnhideMenuItem.react","useIGDMessageUnsendMenuItem.react","useIGDPinnedMessageLimitReachedDialog.react"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=e.useMemo,d={popover:{borderStartStartRadius:"x1rgw4pv",borderStartEndRadius:"x1vjm0to",borderEndEndRadius:"xnqoqkk",borderEndStartRadius:"x16lu3ki",marginBottom:"xu06os2",$$css:!0}};function m(e){var t=o("react-compiler-runtime").c(27),a=e.isMessageHidden,i=e.message,l=e.onClose,c=e.onMessageUnhide,m=e.thread,_=o("MWCMThreadTypes.react").isIGBroadcastChannelThread(m.threadSubtype),f=r("useIGDBroadcastChannelImpressionLoggerWithCheck")(i.threadKey,m.threadSubtype,o("IGDBroadcastChannelLoggingShapes").MESSAGE_OPTIONS_RENDERED_SHAPE),g=o("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),h;t[0]!==g?(h={eventName:"message_contextual_menu_rendered",flowInstanceId:g},t[0]=g,t[1]=h):h=t[1];var y=r("MessengerWebUXLogger").useImpressionLoggerRef(h),C=r("useIGDMessageReplyMenuItem.react")(i,l,a),b=r("useIGDMessageReactionMenuItem.react")(i,l,a),v=r("useIGDEditMessageMenuItem.react")(i,l,m),S=r("useIGDMessageCopyMenuItem.react")(i,l,m,a),R=r("useIGDMessageForwardMenuItem.react")(i,l,a),L=r("useIGDPinnedMessageLimitReachedDialog.react")(),E=n("cr:21429")(i,l,m,L,a),k=r("useIGDMessagePositiveFeedbackMenuItem.react")(i,l,a),I=r("useIGDMessageNegativeFeedbackMenuItem.react")(i,a),T;if(t[2]!==S||t[3]!==v||t[4]!==R||t[5]!==I||t[6]!==E||t[7]!==k||t[8]!==b||t[9]!==C){var D=[b,C,v,R,S,E,k,I];T=D.filter(Boolean),t[2]=S,t[3]=v,t[4]=R,t[5]=I,t[6]=E,t[7]=k,t[8]=b,t[9]=C,t[10]=T}else T=t[10];var x=T,$;t[11]!==i?($=r("isMWEditedMessage")(i),t[11]=i,t[12]=$):$=t[12];var P=$,N;t[13]!==i.timestampMs?(N=(s||(s=o("I64"))).to_float(i.timestampMs),t[13]=i.timestampMs,t[14]=N):N=t[14];var M=r("useIGDMessageTimestampMenuItem.react")(N,P,x.length>0),w=r("useIGDMessageUnsendMenuItem.react")(i,m),A=r("useIGDMessageReportMenuItem.react")(i,m.threadType),F=r("useIGDMessageInspectMenuItem.react")(i),O=r("useIGDMessageUnhideMenuItem.react")(a,c),B;t[15]!==x?(B=x.map(p),t[15]=x,t[16]=B):B=t[16];var W;t[17]!==F||t[18]!==A||t[19]!==B||t[20]!==M||t[21]!==O||t[22]!==w?(W=u.jsx(o("WebUXLoggingSurfaceContextProvider").WebUXSurfaceLoggingContext.Provider,{value:"thread_view_message_options",children:u.jsxs(r("IGDSBox.react"),{minWidth:180,padding:2,children:[M,B,w,A,F,O]})}),t[17]=F,t[18]=A,t[19]=B,t[20]=M,t[21]=O,t[22]=w,t[23]=W):W=t[23];var q=W,U=_?f:y,V;return t[24]!==q||t[25]!==U?(V=u.jsx(r("IGDSPopover.react"),{popoverContent:q,popoverXStyle:d.popover,ref:U}),t[24]=q,t[25]=U,t[26]=V):V=t[26],V}function p(e,t){return u.jsx(r("IGDSBox.react"),{children:e},"igd-message-menu-item-"+t)}p.displayName=p.name+" [from "+i.id+"]",l.default=m}),98);
__d("getSendProfileToInstamadilloRecipient",["fbt","FBLogger","I64","IGDDataclassTypes.flow","LSAuthorityLevel","LSMessageReplySourceTypeV2","LSMessageSendStatus","getErrorSafe","issueSendInstamadilloXMAReceiverFetch","renderInstamadilloOptimisticXmaReceiverFetch"],(function(t,n,r,o,a,i,l,s){"use strict";var e;function u(t,n,a,i,l){if(a==null)throw r("FBLogger")("igd_web").mustfix("getSendProfileToInstamadilloRecipient: missing profileUsername");var u={__typename:"XMSGIgReceiverFetchXmaProfileFetchParams",igid:t},c={__typename:"XMSGIgXmaContentRefDataclass",action_type:o("IGDDataclassTypes.flow").XmsgIgXmaActionType.Share,content_type:o("IGDDataclassTypes.flow").XmsgIgReceiverFetchContentType.Profile,fetch_params:u,owner_fbid:n,target_url:i,username:a},d={contentRef:JSON.stringify(c)},m={authorityLevel:(e||(e=o("I64"))).of_int32(r("LSAuthorityLevel").OPTIMISTIC),isForwarded:l,replySourceTypeV2:l===!0?(e||(e=o("I64"))).of_int32(r("LSMessageReplySourceTypeV2").FORWARD):void 0,sendStatus:e.of_int32(r("LSMessageSendStatus").SENDING_TO_SERVER),sendStatusV2:e.of_int32(1)},p={actionUrl:i,nativeUrl:i,type_:"xma_open_native"},_={authorityLevel:e.of_int32(r("LSAuthorityLevel").OPTIMISTIC),subtitleText:s._(/*BTDS*/"Profile").toString(),titleText:a};return async function(e,t,n,o,a,i){try{var l=await r("renderInstamadilloOptimisticXmaReceiverFetch")(e,d,u,_,p,m);await r("issueSendInstamadilloXMAReceiverFetch")({comment:o,isDisappearingModeSettingOn:t,offlineThreadingId:l,openEb:n,receiverFetchXma:JSON.stringify(d),threadKey:e}),a==null||a(e)}catch(t){var s=r("getErrorSafe")(t);i==null||i(s,e)}}}l.default=u}),226);
__d("getSendReelToInstamadilloRecipient",["fbt","I64","IGDDataclassTypes.flow","LSAuthorityLevel","LSIntEnum","LSMessageReplySourceTypeV2","LSMessageSendStatus","MNXMAPreviewImageDecorationType","getErrorSafe","issueSendInstamadilloXMAReceiverFetch","renderInstamadilloOptimisticXmaReceiverFetch"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u;function c(t,n,a,i,l){var c,d={__typename:"XMSGIgReceiverFetchXmaClipFetchParams",media_igid:t},m={__typename:"XMSGIgXmaContentRefDataclass",action_type:o("IGDDataclassTypes.flow").XmsgIgXmaActionType.Share,content_type:o("IGDDataclassTypes.flow").XmsgIgReceiverFetchContentType.Clip,fetch_params:d,owner_fbid:n,target_url:i,username:a},p={contentRef:JSON.stringify(m)},_={authorityLevel:(e||(e=o("I64"))).of_int32(r("LSAuthorityLevel").OPTIMISTIC),isForwarded:l,replySourceTypeV2:l===!0?(e||(e=o("I64"))).of_int32(r("LSMessageReplySourceTypeV2").FORWARD):void 0,sendStatus:e.of_int32(r("LSMessageSendStatus").SENDING_TO_SERVER),sendStatusV2:e.of_int32(1)},f={actionUrl:i,nativeUrl:i,targetId:e.of_string(t),type_:"igd_web_post_share"},g={authorityLevel:e.of_int32(r("LSAuthorityLevel").OPTIMISTIC),previewImageDecorationType:(u||(u=o("LSIntEnum"))).ofNumber(r("MNXMAPreviewImageDecorationType").REEL),subtitleText:s._(/*BTDS*/"Reel").toString(),titleText:(c=m.username)!=null?c:""};return async function(e,t,n,o,a,i){try{var l=await r("renderInstamadilloOptimisticXmaReceiverFetch")(e,p,d,g,f,_);await r("issueSendInstamadilloXMAReceiverFetch")({comment:o,isDisappearingModeSettingOn:t,offlineThreadingId:l,openEb:n,receiverFetchXma:JSON.stringify(p),threadKey:e}),a==null||a(e)}catch(t){i==null||i(r("getErrorSafe")(t),e)}}}l.default=c}),226);